# Polylang Testing Suite

ะะพะผะฟะปะตะบัะฝะฐั ัะธััะตะผะฐ ัะตััะธัะพะฒะฐะฝะธั ะผะฝะพะณะพัะทััะฝะพััะธ WordPress ัะฐะนัะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ Polylang + ACF.

## ะะฑะทะพั

ะขะตััะพะฒัะน ะฝะฐะฑะพั ะฟัะพะฒะตััะตั ะฟะพะปะฝัั ะธะฝัะตะณัะฐัะธั Polylang ั ะบะฐััะพะผะฝัะผะธ ัะธะฟะฐะผะธ ะฟะพััะพะฒ, ACF ะฟะพะปัะผะธ, ัะฐะบัะพะฝะพะผะธัะผะธ ะธ SEO ะพะฟัะธะผะธะทะฐัะธะตะน. ะัะตะณะพ: **~96+ ะฐะฒัะพะผะฐัะธัะตัะบะธั ัะตััะพะฒ** + ะธะฝัะตัะฐะบัะธะฒะฝัะต ะฟัะพะฒะตัะบะธ.

## ะกัััะบัััะฐ ัะฐะท

### ะคะฐะทะฐ 0: ะัะตะดะฒะฐัะธัะตะปัะฝัะต ะฟัะพะฒะตัะบะธ (5 ัะตััะพะฒ)
**ะฆะตะปั:** ะัะพะฒะตัะบะฐ ะณะพัะพะฒะฝะพััะธ ะพะบััะถะตะฝะธั ะบ ัะตััะธัะพะฒะฐะฝะธั

**ะงัะพ ะฟัะพะฒะตััะตััั:**
- โ SSH ัะพะตะดะธะฝะตะฝะธะต (dev/prod) ะธะปะธ Docker ะบะพะฝัะตะนะฝะตัั (local)
- โ ะะพัััะฟะฝะพััั WP-CLI
- โ ะะพะดะบะปััะตะฝะธะต ะบ ะฑะฐะทะต ะดะฐะฝะฝัั
- โ ะะพัััะฟะฝะพััั ัะฐะนัะฐ (HTTP ััะฐััั 200)
- โ WordPress ะทะฐะณััะถะตะฝ ะบะพััะตะบัะฝะพ

**ะะพะผะฐะฝะดะฐ:**
```bash
./polylang-test.sh --env=local --only=0
```

**ะะตะทัะปััะฐั:** ะะพะดัะฒะตัะถะดะตะฝะธะต, ััะพ ะพะบััะถะตะฝะธะต ะณะพัะพะฒะพ ะบ ัะตััะธัะพะฒะฐะฝะธั Polylang ะธะฝัะตะณัะฐัะธะธ.

---

### ะคะฐะทะฐ 1: ะฃััะฐะฝะพะฒะบะฐ ะธ ะฝะฐัััะพะนะบะฐ Polylang (12 ัะตััะพะฒ)
**ะฆะตะปั:** ะัะพะฒะตัะบะฐ ะฑะฐะทะพะฒะพะน ะบะพะฝัะธะณััะฐัะธะธ Polylang

**ะงัะพ ะฟัะพะฒะตััะตััั:**
- โ Polylang ะฟะปะฐะณะธะฝ ัััะฐะฝะพะฒะปะตะฝ ะธ ะฐะบัะธะฒะตะฝ
- โ ะฏะทัะบะธ ัะพะทะดะฐะฝั (ru, en)
- โ ะะตัะพะปัะฝัะน ัะทัะบ = ru
- โ URL ััััะบัััะฐ (ัะทัะบ ะฒ ะฟััะธ: `/`, `/en/`)
- โ ะกะธะฝััะพะฝะธะทะฐัะธั ัะฐะบัะพะฝะพะผะธะน ะฒะบะปััะตะฝะฐ
- โ ะกะธะฝััะพะฝะธะทะฐัะธั ะบะฐััะพะผะฝัั ะฟะพะปะตะน ะฒะบะปััะตะฝะฐ
- โ ะะฐัััะพะนะบะธ ัะตะผั ะธ ACF ะพะฟัะธะน
- โ ะฏะทัะบะพะฒะฐั ัะฐะฑะปะธัะฐ `wp_term_relationships`

**ะะพะผะฐะฝะดะฐ:**
```bash
./polylang-test.sh --env=local --only=1
```

---

### ะคะฐะทะฐ 2: SQL ะผะธะณัะฐัะธะธ (EN ะผะตะฝั) (18 ัะตััะพะฒ)
**ะฆะตะปั:** ะัะพะฒะตัะบะฐ ะผะธะณัะฐัะธะธ ััััะบัััั ะฝะฐะฒะธะณะฐัะธะธ + ะฟะพะปัะฐะฒัะพะผะฐัะธัะตัะบะธะน ะฟะตัะตะฒะพะด ะฟัะฝะบัะพะฒ ะผะตะฝั

**ะงัะพ ะฟัะพะฒะตััะตััั:**

**ะะปะพะบ 1: ะะฐะทะพะฒะฐั ััััะบัััะฐ ะผะตะฝั (ัะตััั 2.1-2.10)**
- โ EN Header ะผะตะฝั ัะพะทะดะฐะฝะพ
- โ EN Footer ะผะตะฝั ัะพะทะดะฐะฝะพ
- โ ะัะฝะบัั ะผะตะฝั ัะบะพะฟะธัะพะฒะฐะฝั (Home, ัะตะปะตัะพะฝ, email)
- โ ะกัััะบัััะฐ ะผะตะฝั ัะพััะฐะฝะตะฝะฐ (ัะพะดะธัะตะปั-ะฟะพัะพะผะพะบ)
- โ ะฏะทัะบะพะฒัะต ัะฒัะทะธ ัััะฐะฝะพะฒะปะตะฝั (RU โ EN)
- โ ะะตะฝั ะฝะฐะทะฝะฐัะตะฝะพ ะฒ ะปะพะบะฐัะธะธ `header-menu-en`, `footer-menu-en`
- โ ะะตะฝั ะพัะพะฑัะฐะถะฐะตััั ะฝะฐ ััะพะฝัะตะฝะดะต `/en/`

**ะะปะพะบ 2: ะะธะณัะฐัะธั 025 - ะฟะพะปัะฐะฒัะพะผะฐัะธัะตัะบะธะน ะฟะตัะตะฒะพะด (ัะตััั 2.11-2.18)**
- โ ะะธะณัะฐัะธั `025_polylang_translate_menu_items.sql` ัััะตััะฒัะตั
- โ PHP ัะบัะธะฟั `translate-menu-items.php` ัััะตััะฒัะตั ะธ ะธัะฟะพะปะฝัะตะผัะน
- โ ะะพะดัััั RU ะธ EN ะฟัะฝะบัะพะฒ ะผะตะฝั (Header + Footer)
- โ ะะพะปะธัะตััะฒะพ ะฟัะฝะบัะพะฒ ัะพะฒะฟะฐะดะฐะตั (RU โ EN)
- โ ะัะพะฒะตัะบะฐ ะฟะตัะตะฒะพะดะพะฒ ะดะปั ะฟัะฝะบัะพะฒ ัะธะฟะฐ `post_type`
- โ ะะตัะฐััะธั ะผะตะฝั ัะพััะฐะฝะตะฝะฐ (ัะพะดะธัะตะปั-ะฟะพัะพะผะพะบ)

**ะัะพัะตัั ัะพะทะดะฐะฝะธั ะฟะตัะตะฒะพะดะพะฒ ะผะตะฝั:**

**ะะฐัะธะฐะฝั 1: ะะฒัะพะผะฐัะธัะตัะบะธะน (ัะตัะตะท db-migrate)**
```bash
cd www/deployment-scripts/database
./db-migrate.sh apply local
```

- **ะะธะณัะฐัะธั 025** (SQL) โ ะฐะฝะฐะปะธะทะธััะตั ะผะตะฝั ะธ ัะพะทะดะฐัั ะพัััั:
  - `MISSING_TRANSLATION` โ ัััะฐะฝะธัั ะฑะตะท ะฟะตัะตะฒะพะดะฐ (ะฝัะถะฝะพ ัะพะทะดะฐัั)
  - `TRANSLATION_EXISTS` โ ะฟะตัะตะฒะพะดั ะณะพัะพะฒั (ะฟัะฝะบัั ะผะตะฝั ัะพะทะดะฐะดัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ)
  - `ALREADY_EXISTS` โ ะฟัะฝะบัั ะผะตะฝั ัะถะต ัััะตััะฒััั
  - `CUSTOM_LINK` โ ะบะฐััะพะผะฝัะต ัััะปะบะธ (ัััะฝะพะน ะฟะตัะตะฒะพะด ะทะฐะณะพะปะพะฒะบะฐ)

- **ะะธะณัะฐัะธั 026** (PHP) โ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐัั ะฟัะฝะบัั ะผะตะฝั ะดะปั ัััะตััะฒัััะธั ะฟะตัะตะฒะพะดะพะฒ

ะัะปะธ ะตััั `MISSING_TRANSLATION`, ะผะธะณัะฐัะธั ะฟะพะบะฐะถะตั ัะฟะธัะพะบ ัััะฐะฝะธั ั ัััะปะบะฐะผะธ ะฝะฐ wp-admin.

**ะะฐัะธะฐะฝั 2: ะะฝัะตัะฐะบัะธะฒะฝัะน (ั ะฑัะฐัะทะตัะพะผ)**
```bash
cd www/wordpress/database/migrations
php 026_polylang_translate_menu_items.php --env=local --interactive
```

ะะปั ะบะฐะถะดะพะน ะฝะตะฟะตัะตะฒะตะดัะฝะฝะพะน ัััะฐะฝะธัั:
- ๐ ะัะฐัะทะตั ะพัะบัะพะตััั ะฝะฐ `/wp-admin/post.php?post=XXX&action=edit`
- ๐ ะะฐะถะผะธัะต **"+ EN"** ะฒ ะฑะปะพะบะต Languages (ัะฟัะฐะฒะฐ)
- ๐ ะ ะฝะพะฒะพะผ ะพะบะฝะต ะฝะฐะถะผะธัะต **"ะะฟัะฑะปะธะบะพะฒะฐัั"**
- โ ะะตัะฝะธัะตัั ะฒ ัะตัะผะธะฝะฐะป ะธ ะฝะฐะถะผะธัะต **Enter**
- ๐ ะกะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐัั ะฟัะฝะบั ะผะตะฝั

**ะัะพะฒะตัะบะฐ ัะตะทัะปััะฐัะฐ:**
```bash
./polylang-test.sh --env=local --only=2
```

ะะถะธะดะฐะตะผัะน ัะตะทัะปััะฐั:
```
โ [2.14] ะะพะปะธัะตััะฒะพ ะฟัะฝะบัะพะฒ EN Header ะผะตะฝั ัะพะฒะฟะฐะดะฐะตั ั RU
โ [2.16] ะะพะปะธัะตััะฒะพ ะฟัะฝะบัะพะฒ EN Footer ะผะตะฝั ัะพะฒะฟะฐะดะฐะตั ั RU
โ [2.17] ะัะต ะฟัะฝะบัั ะผะตะฝั ัะธะฟะฐ 'post_type' ะธะผะตัั ะฟะตัะตะฒะพะดั ัััะฐะฝะธั
โ [2.18] ะะตัะฐััะธั ะผะตะฝั ัะพััะฐะฝะตะฝะฐ
```

**ะะพะผะฐะฝะดั:**
```bash
# ะขะตัั ัะฐะทั 2
./polylang-test.sh --env=local --only=2

# ะัะธะผะตะฝะธัั ะผะธะณัะฐัะธะธ
cd www/deployment-scripts/database
./db-migrate.sh apply local

# ะะฝัะตัะฐะบัะธะฒะฝัะน ัะตะถะธะผ (ะฟะพัะปะต ัะพะทะดะฐะฝะธั ะฟะตัะตะฒะพะดะพะฒ)
cd www/wordpress/database/migrations
php 026_polylang_translate_menu_items.php --env=local --interactive
```

**ะะพะดะดะตัะถะบะฐ ะพะบััะถะตะฝะธะน:**
- **local**: Docker Compose (ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพัะบััะฒะฐะตั `https://localhost/wp-admin/...`)
- **dev**: SSH ะฝะฐ `dev.maslovka.org` (ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพัะบััะฒะฐะตั dev URL)
- **prod**: SSH ะฝะฐ `maslovka.org` (ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพัะบััะฒะฐะตั prod URL)

---

### ะคะฐะทะฐ 3: ะะตัะตะฒะพะดั ัะตะผั (14 ัะตััะพะฒ)
**ะฆะตะปั:** ะัะพะฒะตัะบะฐ ะปะพะบะฐะปะธะทะฐัะธะธ ัะตะผั

**ะงัะพ ะฟัะพะฒะตััะตััั:**
- โ ะคะฐะนะปั ะฟะตัะตะฒะพะดะพะฒ ัััะตััะฒััั (`en_US.mo`, `maslovka.pot`)
- โ `load_theme_textdomain()` ะฟะพะดะบะปััะตะฝ ะฒ ัะตะผะต
- โ ะกััะฐะฝะธัะฐ 404 ะฟะตัะตะฒะตะดะตะฝะฐ ะฝะฐ EN
- โ Search ัะพัะผะฐ ะฟะตัะตะฒะตะดะตะฝะฐ ะฝะฐ EN
- โ ะะตัะตะบะปััะฐัะตะปั ัะทัะบะพะฒ ัะฐะฑะพัะฐะตั
- โ ะััะธะฒั CPT ะดะพัััะฟะฝั ะฝะฐ EN (`/en/artists/`, `/en/collection/`)
- โ Single ะฟะพััั ะดะพัััะฟะฝั ะฝะฐ EN (`/en/artist/...`)
- โ ะะตะดะธัะตะบั ั `/en/artist/` ะฝะฐ `/en/artists/` (ะตะดะธะฝััะฒะตะฝะฝะพะต ัะธัะปะพ)

**ะะพะผะฐะฝะดะฐ:**
```bash
./polylang-test.sh --env=local --only=3
```

---

### ะคะฐะทะฐ 4-5: ะะฐััะพะผะฝัะต ะฟะปะฐะณะธะฝั ะธ ะดะตะผะพ-ะบะพะฝัะตะฝั (61 ัะตัั)
**ะฆะตะปั:** ะะพะผะฟะปะตะบัะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะบะพะฟะธัะพะฒะฐะฝะธั ACF ะฟะพะปะตะน ะธ ัะฐะบัะพะฝะพะผะธะน

**ะะปะพัะฝะฐั ััััะบัััะฐ:**
- **ะะปะพะบ A** (4 ัะตััะฐ) โ ะะพะดะณะพัะพะฒะบะฐ ะพะบััะถะตะฝะธั
- **ะะปะพะบ B** (10 ัะตััะพะฒ) โ ะะฒัะพัะพะทะดะฐะฝะธะต ัะตัะผะธะฝะพะฒ ั ะฟะตัะตะฒะพะดะฐะผะธ
- **ะะปะพะบ C** (9 ัะตััะพะฒ) โ ะขะตััะธัะพะฒะฐะฝะธะต CPT `artist`
- **ะะปะพะบ D** (8 ัะตััะพะฒ) โ ะขะตััะธัะพะฒะฐะฝะธะต CPT `collection`
- **ะะปะพะบ E** (9 ัะตััะพะฒ) โ ะขะตััะธัะพะฒะฐะฝะธะต CPT `events`
- **ะะปะพะบ F** (7 ัะตััะพะฒ) โ ะขะตััะธัะพะฒะฐะฝะธะต CPT `vistavki`
- **ะะปะพะบ G** (4 ัะตััะฐ) โ ะะฝะฐะปะธะท ะฟะพะบัััะธั ะฟะตัะตะฒะพะดะพะฒ ัะฐะบัะพะฝะพะผะธะน
- **ะะปะพะบ H** (3 ัะตััะฐ) โ ะัะพะฒะตัะบะฐ Polylang ัะตะดะธัะตะบัะพะฒ
- **ะะปะพะบ I** (3 ัะตััะฐ) โ ะัะธััะบะฐ ัะตััะพะฒัั ะดะฐะฝะฝัั

**ะงัะพ ะฟัะพะฒะตััะตััั:**
- โ mu-plugin `maslovka-polylang-acf.php` ะฐะฒัะพะผะฐัะธัะตัะบะธ ะบะพะฟะธััะตั ACF ะฟะพะปั
- โ ะกะฒัะทะธ ัะฐะบัะพะฝะพะผะธะน ะบะพะฟะธัััััั ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผ ะฟะตัะตะฒะพะดะพะผ ัะตัะผะธะฝะพะฒ
- โ ะะฐะปะตัะตะธ ะธะทะพะฑัะฐะถะตะฝะธะน ะบะพะฟะธัััััั (Polylang ะดัะฑะปะธััะตั attachments)
- โ Post-to-post relationships (`artist_id`) ะบะพะฟะธัััััั ั ะฟะตัะตะฒะพะดะพะผ
- โ Repeater ะฟะพะปั (`content_block`) ะบะพะฟะธัััััั ั ะฒะปะพะถะตะฝะฝัะผะธ ะทะฝะฐัะตะฝะธัะผะธ
- โ Polylang ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐัั ัะตะดะธัะตะบัั ะฟัะธ ัะพะทะดะฐะฝะธะธ ะฟะตัะตะฒะพะดะพะฒ
- โ ะัะธััะบะฐ ัะตััะพะฒัั ะดะฐะฝะฝัั ะฝะต ะทะฐััะฐะณะธะฒะฐะตั ะฟัะพะดะฐะบัะฝ ะบะพะฝัะตะฝั

**ะะตะฐะปัะฝัะต ะดะฐะฝะฝัะต ะฟัะพะตะบัะฐ:**

**CPT ะธ ACF ะฟะพะปั:**
- **artist**: first_name, patronymic, birth_date, death_date, ัะฐะฑะพัั_ััะดะพะถะฝะธะบะฐ, ัะพัะพ_ััะดะพะถะฝะธะบะฐ
- **collection**: artist_id, year_created, current_location, height, width, depth
- **events**: ัััะปะบะฐ_ะดะปั_ะบะฝะพะฟะบะธ, ัะตะบัั_ะฒ_ะบะฝะพะฟะบะต, ัะฒะตั_ะฑะปะพะบะฐ, ะดะฐัะฐ_ะฝะฐัะฐะปะฐ, ะดะฐัะฐ, ัะฒะตั_ัะตะบััะฐ_ัะพะฑััะธั, content_block
- **vistavki**: ะพะฟะธัะฐะฝะธะต_ะผะตัะพะฟัะธััะธั, ัััะปะบะฐ_ะบัะฟะธัั, ัะตะบัั_ะฒ_ะบะฝะพะฟะบะต, ะะฐััะธะฝะบะฐ_ะฒัััะฐะฒะบะธ, content_block

**ะขะฐะบัะพะฝะพะผะธะธ:**
- `art_form`, `period`, `genres`, `styles` (artist + collection)
- `techniques`, `materials` (collection)
- `artist_group`, `education` (artist)
- `event_types` (events)

**ะะฝัะตัะฐะบัะธะฒะฝัะต ัะฐะณะธ:**

ะขะตััั ััะตะฑััั ัััะฝะพะณะพ ัะพะทะดะฐะฝะธั EN ะฟะตัะตะฒะพะดะพะฒ ะดะปั ะฟัะพะฒะตัะบะธ ัะฐะฑะพัั mu-plugin:

1. ะัะฐัะทะตั ะพัะบัะพะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฝะฐ ัััะฐะฝะธัะต ัะตะดะฐะบัะธัะพะฒะฐะฝะธั RU ะฟะพััะฐ
2. ะ ะฑะปะพะบะต Languages (ัะฟัะฐะฒะฐ) ะฝะฐะถะผะธัะต **"+ EN"**
3. ะ ะฝะพะฒะพะผ ะพะบะฝะต ะฝะฐะถะผะธัะต **"ะะฟัะฑะปะธะบะพะฒะฐัั"** (ACF ะฟะพะปั ัะบะพะฟะธัััััั ะฐะฒัะพะผะฐัะธัะตัะบะธ)
4. ะะตัะฝะธัะตัั ะฒ ัะตัะผะธะฝะฐะป ะธ ะฝะฐะถะผะธัะต Enter

**ะะพะผะฐะฝะดะฐ:**
```bash
./polylang-test.sh --env=local --only=4

# ะก ัะพััะฐะฝะตะฝะธะตะผ ะปะพะณะฐ
./polylang-test.sh --env=local --only=4 2>&1 | tee phase-4-5.log
```

**ะะตัะฐะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั:** [phase-4-5/README.md](phase-4-5/README.md)

---

### ะคะฐะทะฐ 6: SEO ะพะฟัะธะผะธะทะฐัะธั (45+ ัะตััะพะฒ)
**ะฆะตะปั:** ะัะพะฒะตัะบะฐ SEO ะฝะฐัััะพะตะบ ะธ ะผะธะบัะพัะฐะทะผะตัะบะธ

**ะงัะพ ะฟัะพะฒะตััะตััั:**
- โ Hreflang ัะตะณะธ ะฝะฐ ะณะปะฐะฒะฝะพะน ัััะฐะฝะธัะต (ru, en)
- โ Hreflang ัะตะณะธ ะฝะฐ EN ะฒะตััะธะธ ัะฐะนัะฐ
- โ ะคัะฝะบัะธั `maslovka_maybe_disable_hreflang()` ะฒ ัะตะผะต
- โ Canonical URL ะฝะฐ ะณะปะฐะฒะฝะพะน ะธ EN ะฒะตััะธะธ
- โ Open Graph ัะตะณะธ (og:locale, og:title, og:image)
- โ Meta ะพะฟะธัะฐะฝะธั ะฝะฐ RU ะธ EN
- โ ะกัััะบัััะธัะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต (JSON-LD Schema.org)
- โ Robots meta ัะตะณะธ
- โ XML Sitemap ัััะตััะฒัะตั ะธ ะดะพัััะฟะตะฝ
- โ Sitemap ัะพะดะตัะถะธั URL ั ัะทัะบะพะฒัะผะธ ะฟัะตัะธะบัะฐะผะธ

**ะะพะผะฐะฝะดะฐ:**
```bash
./polylang-test.sh --env=local --only=6
```

---

## ะะฐะฟััะบ ัะตััะพะฒ

### ะะฐะทะพะฒัะต ะบะพะผะฐะฝะดั

```bash
# ะะฐะฟัััะธัั ะฒัะต ัะฐะทั
./polylang-test.sh --env=local

# ะะฐะฟัััะธัั ะบะพะฝะบัะตัะฝัั ัะฐะทั
./polylang-test.sh --env=local --only=1

# ะะฐะฟัััะธัั ะฝะตัะบะพะปัะบะพ ัะฐะท
./polylang-test.sh --env=local --only=1,2,3

# ะะฐะฟัััะธัั ั ะพะฟัะตะดะตะปัะฝะฝะพะน ัะฐะทั
./polylang-test.sh --env=local --phase=4

# ะัะธะฝัะดะธัะตะปัะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั SQL ะฒะผะตััะพ WP-CLI
./polylang-test.sh --env=local --force-sql

# ะก ัะพััะฐะฝะตะฝะธะตะผ ะปะพะณะฐ
./polylang-test.sh --env=local 2>&1 | tee polylang-tests.log
```

### ะัะปััะธ-ะพะบััะถะตะฝะธะต

ะขะตััั ะฟะพะดะดะตัะถะธะฒะฐัั **local**, **dev** ะธ **prod** ะพะบััะถะตะฝะธั:

```bash
# ะะพะบะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต (Docker)
./polylang-test.sh --env=local --only=4

# Dev ะพะบััะถะตะฝะธะต (SSH)
./polylang-test.sh --env=dev --only=0,1,2,3

# Prod ะพะบััะถะตะฝะธะต (SSH)
./polylang-test.sh --env=prod --only=0,1,2,3
```

**ะะปััะตะฒัะต ัะฐะทะปะธัะธั:**
- **Local**: ะธัะฟะพะปัะทัะตั Docker Compose (`docker compose exec -T php wp ...`)
- **Dev/Prod**: ะธัะฟะพะปัะทััั SSH (`ssh -p $SSH_PORT user@host "wp ..."`)

**ะะตะบะพะผะตะฝะดะฐัะธะธ ะดะปั dev/prod:**
- **ะคะฐะทั 0-3** โ ะฟะพะปะฝะพัััั ะฑะตะทะพะฟะฐัะฝั, ัะพะปัะบะพ ะฟัะพะฒะตัะบะธ ะบะพะฝัะธะณััะฐัะธะธ
- **ะคะฐะทะฐ 4-5** โ ัะพะทะดะฐัั ัะตััะพะฒัะต ะดะฐะฝะฝัะต, ะฝะพ ัะดะฐะปัะตั ะธั ะฒ ะฑะปะพะบะต I (ัะตะบะพะผะตะฝะดัะตััั ะฑัะบะฐะฟ)
- **ะคะฐะทะฐ 6** โ ัะพะปัะบะพ ััะตะฝะธะต (ะฟัะพะฒะตัะบะฐ SEO ัะตะณะพะฒ)

---

## ะััะธัะตะบัััะฐ

```
polylang-test.sh              ะะปะฐะฒะฝัะน ัะฐะฝะฝะตั
polylang-tests/
โโโ common.sh                 ะะฑัะธะต ััะฝะบัะธะธ (test_pass, test_fail, run_wp_cli)
โโโ phase-0.sh                ะัะตะดะฒะฐัะธัะตะปัะฝัะต ะฟัะพะฒะตัะบะธ
โโโ phase-1.sh                ะะฐัััะพะนะบะฐ Polylang
โโโ phase-2.sh                SQL ะผะธะณัะฐัะธะธ (ะผะตะฝั)
โโโ phase-3.sh                ะะตัะตะฒะพะดั ัะตะผั
โโโ phase-4-5.sh              ะัะบะตัััะฐัะพั ะฑะปะพะบะพะฒ A-I
โโโ phase-6.sh                SEO ะพะฟัะธะผะธะทะฐัะธั
โโโ phase-4-5/
    โโโ common.sh             ะะปะพะบ-ัะฟะตัะธัะธัะฝัะต ััะฝะบัะธะธ
    โโโ block-a-preparation.sh
    โโโ block-b-terms.sh
    โโโ block-c-artist.sh
    โโโ block-d-collection.sh
    โโโ block-e-events.sh
    โโโ block-f-vistavki.sh
    โโโ block-g-coverage.sh
    โโโ block-h-redirects.sh
    โโโ block-i-cleanup.sh
```

---

## ะขัะตะฑะพะฒะฐะฝะธั

### ะะพะบะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต:
- Docker Compose (ะดะปั WordPress ะบะพะฝัะตะนะฝะตัะฐ)
- WP-CLI ะฒ ะบะพะฝัะตะนะฝะตัะต
- ะะธะฝะธะผัะผ 3 ะธะทะพะฑัะฐะถะตะฝะธั ะฒ ะผะตะดะธะฐะฑะธะฑะปะธะพัะตะบะต (ะดะปั ัะฐะทั 4-5)
- ะัะฐัะทะตั (ะดะปั ะธะฝัะตัะฐะบัะธะฒะฝัั ะฟัะพะฒะตัะพะบ)

### Dev/Prod ะพะบััะถะตะฝะธะต:
- SSH ะดะพัััะฟ (ะฝะฐัััะพะตะฝ ะฒ `config.sh`)
- WP-CLI ะฝะฐ ัะดะฐะปัะฝะฝะพะผ ัะตัะฒะตัะต
- ะะพัััะฟ ะบ wp-admin ะดะปั ะธะฝัะตัะฐะบัะธะฒะฝัั ัะฐะณะพะฒ
- Basic Auth (ะตัะปะธ ะฝะฐัััะพะตะฝ: `test:test`)

### WordPress ะฟะปะฐะณะธะฝั:
- **Polylang** (ะฐะบัะธะฒะตะฝ)
- **ACF Pro** (ะดะปั ะบะฐััะพะผะฝัั ะฟะพะปะตะน)
- **mu-plugin** `maslovka-polylang-acf.php` (ะดะปั ะฐะฒัะพะบะพะฟะธัะพะฒะฐะฝะธั ะฟะพะปะตะน)
- **maslovka-custom-fields** (ะฟะปะฐะณะธะฝ ั CPT ะธ ACF ะณััะฟะฟะฐะผะธ)
- **maslovka-redirects** (ะบะฐััะพะผะฝะฐั ัะฐะฑะปะธัะฐ ัะตะดะธัะตะบัะพะฒ)

---

## ะะฝัะตัะฟัะตัะฐัะธั ัะตะทัะปััะฐัะพะฒ

### ะกัะฐัะธััะธะบะฐ ัะตััะพะฒ
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ       ะะะะฃะะฌะขะะขะซ ะขะะกะขะะะะะะะะฏ              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ  โ ะัะพะนะดะตะฝะพ:      60 ัะตััะพะฒ                โ
โ  โ ะัะพะฒะฐะปะตะฝะพ:      0 ัะตััะพะฒ                โ
โ  โ ะัะพะฟััะตะฝะพ:      1 ัะตัั                  โ
โ  โน ะะฝัะพัะผะฐัะธั:     8 ะทะฐะผะตัะพะบ               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ  ะฃัะฟะตัะฝะพััั:      98.4%                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะขะธะฟั ัะตะทัะปััะฐัะพะฒ:
- **โ test_pass** โ ัะตัั ััะฟะตัะฝะพ ะฟัะพะนะดะตะฝ
- **โ test_fail** โ ัะตัั ะฟัะพะฒะฐะปะตะฝ (ััะตะฑัะตั ะฒะฝะธะผะฐะฝะธั)
- **โ test_skip** โ ัะตัั ะฟัะพะฟััะตะฝ (ะพะถะธะดะฐะตะผะพะต ะฟะพะฒะตะดะตะฝะธะต)
- **โน test_info** โ ะธะฝัะพัะผะฐัะธะพะฝะฝะพะต ัะพะพะฑัะตะฝะธะต (ะฝะต ะพัะธะฑะบะฐ)

### ะะทะฒะตััะฝัะต ะพะณัะฐะฝะธัะตะฝะธั:
- Select ะฟะพะปั (`status`) ะฟัะพะฒะตัััััั ัะพะปัะบะพ ะฒะธะทัะฐะปัะฝะพ (ะฝะต ะฐะฒัะพะผะฐัะธัะตัะบะธ)
- ะะตะบะพัะพััะต ACF ะฟะพะปั ะฝะต ะบะพะฟะธัััััั ะฐะฒัะพะผะฐัะธัะตัะบะธ (ะดะพะบัะผะตะฝัะธัะพะฒะฐะฝะฝะพะต ะฟะพะฒะตะดะตะฝะธะต Polylang)
- ะััะธะฒะฝัะต URL ะผะพะณัั ะฒัะตะผะตะฝะฝะพ ะฝะต ัะฐะฑะพัะฐัั (ะบัั rewrite rules)
- ะะฐะปะตัะตะธ ะดัะฑะปะธัััััั ะดะปั EN ะฒะตััะธะธ (ะพะถะธะดะฐะตะผะพะต ะฟะพะฒะตะดะตะฝะธะต Polylang)

---

## ะัะปะฐะดะบะฐ

### ะัะพะฒะตัะบะฐ SSH ัะพะตะดะธะฝะตะฝะธั (dev/prod):
```bash
cd www/deployment-scripts
./test-ssh-connection.sh dev
./test-ssh-connection.sh prod
```

### ะัะพะฒะตัะบะฐ Docker ะบะพะฝัะตะนะฝะตัะพะฒ (local):
```bash
cd www
docker compose ps
docker compose logs php
```

### ะัะพะฒะตัะบะฐ WP-CLI:
```bash
# Local
docker compose -f www/docker-compose.yml exec -T php wp --info

# Dev/Prod
ssh -p $SSH_PORT user@host "wp --info"
```

### ะัะพะฒะตัะบะฐ ะฑะฐะทั ะดะฐะฝะฝัั:
```bash
# ะฏะทัะบะธ Polylang
wp term list language --format=table

# ะกะฒัะทะธ ะฟะตัะตะฒะพะดะพะฒ
wp db query "SELECT * FROM wp_term_relationships WHERE term_taxonomy_id IN (SELECT term_id FROM wp_terms WHERE slug IN ('ru', 'en'))"

# ACF ะณััะฟะฟั ะฟะพะปะตะน
wp acf field-group list
```

---

## ะะพะดะดะตัะถะบะฐ

- **ะัะฝะพะฒะฝะพะน runner:** `polylang-test.sh`
- **ะะพะฝัะธะณััะฐัะธั:** `config.sh`
- **ะะฑัะธะต ััะฝะบัะธะธ:** `polylang-tests/common.sh`
- **ะะตัะฐะปะธ ัะฐะทั 4-5:** `polylang-tests/phase-4-5/README.md`

**ะะตััะธั:** 2.0 (ะผะพะดัะปัะฝะฐั ะฐััะธัะตะบัััะฐ)  
**ะะฐัะฐ:** ะะตะบะฐะฑัั 2025
