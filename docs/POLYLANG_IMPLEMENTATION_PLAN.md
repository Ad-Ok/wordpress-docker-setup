# üåç –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏ –¥–ª—è Maslovka.org

**–î–∞—Ç–∞:** 3 –¥–µ–∫–∞–±—Ä—è 2025  
**–Ø–∑—ã–∫–∏:** –†—É—Å—Å–∫–∏–π (–æ—Å–Ω–æ–≤–Ω–æ–π) + –ê–Ω–≥–ª–∏–π—Å–∫–∏–π  
**–í–µ—Ä—Å–∏—è Polylang:** FREE + –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã  

---

## üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—è

```
‚úÖ Polylang FREE (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è)
‚úÖ –†–∞–∑–Ω—ã–µ slug'–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤
‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø–ª–∞–≥–∏–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ (/en/post/ ‚Üí /en/post-2/)
‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
‚úÖ –†–∞–±–æ—Ç–∞ –Ω–∞ PROD, local/dev –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚úÖ SQL –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚úÖ –ú–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (~30 CPT, —Å–æ—Ç–Ω–∏ –ø–æ—Å—Ç–æ–≤)
‚úÖ Slug'–∏ —Ç—Ä–∞–Ω—Å–ª–∏—Ç–æ–º
```

---

## üöÄ –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω

### –§–∞–∑–∞ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Polylang (LOCAL) - 2-3 —á–∞—Å–∞

**1.1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Polylang FREE**
```bash
# WordPress Admin ‚Üí Plugins ‚Üí Add New
# –ó–∞–≥—Ä—É–∑–∏—Ç—å polylang.zip ‚Üí Activate
```

**1.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —è–∑—ã–∫–æ–≤**
```
Settings ‚Üí Languages ‚Üí Languages

Add New Language:
1. Russian (–†—É—Å—Å–∫–∏–π)
   - Locale: ru_RU
   - Flag: üá∑üá∫
   - Set as default: YES
   - URL modification: Remove language info from URL ‚úÖ

2. English
   - Locale: en_US  
   - Flag: üá∫üá∏
   - URL modification: /en/

Settings:
‚úÖ Hide URL language info for default
‚úÖ Media: Enable translation
‚úÖ The front page URL contains the language code instead of the page name or page id
   (—á—Ç–æ–±—ã EN –≥–ª–∞–≤–Ω–∞—è –±—ã–ª–∞ /en/, –∞ –Ω–µ /en/slug-of-english-homepage/)
‚úÖ There are posts, pages, categories or tags without language. You can set them all to the default language. - –Ω–∞–∂–∞—Ç—å!
```

**1.3. –í–∫–ª—é—á–∏—Ç—å CPT –∏ —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏**
```
Settings ‚Üí Languages ‚Üí Settings ‚Üí Custom post types

‚úÖ Collections
‚úÖ Vistavki  
‚úÖ Events (Sobitiya)
‚úÖ Artists
‚úÖ Photo

(Page, Post, Attachment –≤–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

Custom taxonomies:
‚úÖ art_form
‚úÖ artist_group
‚úÖ education
‚úÖ event_types
‚úÖ genres
‚úÖ materials
‚úÖ period
‚úÖ styles
‚úÖ techniques
```

**1.4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫**

**–í–∞—Ä–∏–∞–Ω—Ç A: SQL-–∑–∞–ø—Ä–æ—Å—ã (phpMyAdmin, Adminer, MySQL CLI)**
```sql
-- 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —è–∑—ã–∫–∏ —Å–æ–∑–¥–∞–Ω—ã
SELECT t.name, t.slug, tt.count 
FROM wp_terms t 
JOIN wp_term_taxonomy tt ON t.term_id = tt.term_id 
WHERE tt.taxonomy = 'language';
-- –û–∂–∏–¥–∞–µ–º–æ: –†—É—Å—Å–∫–∏–π (ru), English (en)

-- 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Polylang
SELECT option_value FROM wp_options WHERE option_name = 'polylang';
-- –ò—Å–∫–∞—Ç—å: "default_lang";s:2:"ru"
-- –ò—Å–∫–∞—Ç—å: "hide_default";b:1
-- –ò—Å–∫–∞—Ç—å: "browser";b:1
```

**–í–∞—Ä–∏–∞–Ω—Ç B: WP-CLI (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–ª–∞–≥–∏–Ω –∞–∫—Ç–∏–≤–µ–Ω
wp plugin list | grep polylang

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Polylang
wp option get polylang --format=yaml
# –ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:
# - default_lang: ru
# - hide_default: true
# - rewrite: true  
# - browser: true
# - post_types: [artist, collection, events, photo, vistavki]
```

**–í–∞—Ä–∏–∞–Ω—Ç C: curl (–ø—Ä–æ–≤–µ—Ä–∫–∞ URL)**
```bash
# RU –≥–ª–∞–≤–Ω–∞—è (–±–µ–∑ /ru/)
curl -I https://localhost/ 2>&1 | grep HTTP
# –û–∂–∏–¥–∞–µ–º–æ: HTTP/2 200

# EN –≥–ª–∞–≤–Ω–∞—è (—Å /en/)
curl -I https://localhost/en/ 2>&1 | grep HTTP
# –û–∂–∏–¥–∞–µ–º–æ: HTTP/2 200
```

**–í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!):**
```
1. Settings ‚Üí Languages
   ‚úÖ 2 —è–∑—ã–∫–∞ –≤ —Å–ø–∏—Å–∫–µ: –†—É—Å—Å–∫–∏–π (default), English
   ‚úÖ URL modification: Hide for default = ON
   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –≤–∏–¥–∞ There are posts, pages, categories or tags without language

2. Settings ‚Üí Languages ‚Üí Settings
   ‚úÖ CPT: collections, vistavki, events, artists, photo
   ‚úÖ Taxonomies: –≤—Å–µ –Ω—É–∂–Ω—ã–µ –≤–∫–ª—é—á–µ–Ω—ã
   
3. –û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   ‚úÖ https://localhost/ ‚Üí —Ä—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è
   ‚úÖ https://localhost/en/ ‚Üí –∞–Ω–≥–ª–∏–π—Å–∫–∞—è –≤–µ—Ä—Å–∏—è
```

**–ß–µ–∫-–ª–∏—Å—Ç –§–∞–∑—ã 1:**
- [ ] Polylang —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–∞ LOCAL/DEV/PROD
- [ ] –Ø–∑—ã–∫–∏ —Å–æ–∑–¥–∞–Ω—ã: ru (default), en
- [ ] CPT –≤–∫–ª—é—á–µ–Ω—ã: collections, vistavki, events, artists, photo
- [ ] –¢–∞–∫—Å–æ–Ω–æ–º–∏–∏ –≤–∫–ª—é—á–µ–Ω—ã
- [ ] hide_default = true, rewrite = true
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–∞ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –§–∞–∑—ã 1 –¥–µ–ª–∞—é—Ç—Å—è **–≤—Ä—É—á–Ω—É—é –æ–¥–∏–Ω–∞–∫–æ–≤–æ** –Ω–∞ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö (LOCAL, DEV, PROD). –ú–µ–Ω—é –∏ –ø–µ—Ä–µ–≤–æ–¥—ã —Å—Ç—Ä–æ–∫ —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –§–∞–∑–µ 2.

---

### –§–∞–∑–∞ 2: –°–æ–∑–¥–∞–Ω–∏–µ SQL –º–∏–≥—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ –º–µ–Ω—é –∏ —Å—Ç—Ä–æ–∫–∏) - 1 —á–∞—Å

> ‚úÖ –Ø–∑—ã–∫–∏ –∏ CPT –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é –≤ –§–∞–∑–µ 1 –Ω–∞ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö –æ–¥–∏–Ω–∞–∫–æ–≤–æ

**2.1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∏–≥—Ä–∞—Ü–∏–π**
```
www/deployment-scripts/database/migrations/
‚îú‚îÄ‚îÄ 001-polylang-menus.sql
‚îî‚îÄ‚îÄ 002-polylang-string-translations.sql
```

**2.2. –ú–∏–≥—Ä–∞—Ü–∏—è 1: –ú–µ–Ω—é** (`001-polylang-menus.sql`)

**–°–æ–∑–¥–∞–Ω–∏–µ –º–µ–Ω—é –Ω–∞ LOCAL:**
```
Appearance ‚Üí Menus

Menu 1: "Main Menu RU"
- –ù–∞–∑–Ω–∞—á–∏—Ç—å —è–∑—ã–∫: Russian
- Theme location: Primary Menu
- –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é

Menu 2: "Main Menu EN"
- –ù–∞–∑–Ω–∞—á–∏—Ç—å —è–∑—ã–∫: English
- Theme location: Primary Menu
- –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é
```

**–≠–∫—Å–ø–æ—Ä—Ç –º–µ–Ω—é:**
```bash
# –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –º–µ–Ω—é –Ω–∞ LOCAL:
mysqldump -u root -p wordpress_db \
  --no-create-info \
  --where="term_id IN (SELECT term_id FROM wp_term_taxonomy WHERE taxonomy = 'nav_menu')" \
  wp_terms wp_term_taxonomy wp_term_relationships \
  > 001-polylang-menus.sql
```

**2.3. –ú–∏–≥—Ä–∞—Ü–∏—è 2: –°—Ç—Ä–æ–∫–∏** (`002-polylang-string-translations.sql`)
```sql
-- –°–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫ —Ç–µ–º—ã (–§–∞–∑–∞ 3)
-- –≠–∫—Å–ø–æ—Ä—Ç –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏–∑ wp_options (polylang_mo_*)
```

**2.4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π**

**SQL-–∑–∞–ø—Ä–æ—Å—ã (phpMyAdmin, Adminer, MySQL CLI):**
```sql
-- 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ–Ω—é —Å–æ–∑–¥–∞–Ω—ã
SELECT t.term_id, t.name, tt.taxonomy
FROM wp_terms t 
JOIN wp_term_taxonomy tt ON t.term_id = tt.term_id 
WHERE tt.taxonomy = 'nav_menu';
-- –û–∂–∏–¥–∞–µ–º–æ: Main Menu RU, Main Menu EN

-- 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑—å –º–µ–Ω—é —Å —è–∑—ã–∫–∞–º–∏
SELECT t.name as menu_name, tr.object_id, lang.name as language
FROM wp_terms t
JOIN wp_term_taxonomy tt ON t.term_id = tt.term_id
JOIN wp_term_relationships tr ON t.term_id = tr.object_id
JOIN wp_term_taxonomy lang_tt ON tr.term_taxonomy_id = lang_tt.term_taxonomy_id
JOIN wp_terms lang ON lang_tt.term_id = lang.term_id
WHERE tt.taxonomy = 'nav_menu' AND lang_tt.taxonomy = 'language';
```

**curl (–ø—Ä–æ–≤–µ—Ä–∫–∞ URL):**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–±–µ —è–∑—ã–∫–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
curl -I https://localhost/ | grep HTTP
curl -I https://localhost/en/ | grep HTTP
# –û–±–∞ –¥–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å 200
```

**–í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
```
1. Appearance ‚Üí Menus
   ‚úÖ Main Menu RU –≤–∏–¥–µ–Ω —Å —è–∑—ã–∫–æ–º "–†—É—Å—Å–∫–∏–π"
   ‚úÖ Main Menu EN –≤–∏–¥–µ–Ω —Å —è–∑—ã–∫–æ–º "English"
   ‚úÖ –û–±–∞ –º–µ–Ω—é –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –Ω–∞ Primary Menu

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
   ‚úÖ –ù–∞ / –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä—É—Å—Å–∫–æ–µ –º–µ–Ω—é
   ‚úÖ –ù–∞ /en/ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ –º–µ–Ω—é
```

**–ß–µ–∫-–ª–∏—Å—Ç –§–∞–∑—ã 2:**
- [ ] –ú–µ–Ω—é —Å–æ–∑–¥–∞–Ω—ã –Ω–∞ LOCAL –¥–ª—è –æ–±–æ–∏—Ö —è–∑—ã–∫–æ–≤
- [ ] SQL-–∑–∞–ø—Ä–æ—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 2 –º–µ–Ω—é —Å —Ä–∞–∑–Ω—ã–º–∏ —è–∑—ã–∫–∞–º–∏
- [ ] 001-polylang-menus.sql —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] db-migrate.sh –æ–±–Ω–æ–≤–ª–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- [ ] –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ git
- [ ] Git commit –º–∏–≥—Ä–∞—Ü–∏–π

---

### –§–∞–∑–∞ 3: –ü–µ—Ä–µ–≤–æ–¥—ã —Ç–µ–º—ã - 2-3 —á–∞—Å–∞

> **–ü–æ–¥—Ö–æ–¥**: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ø–µ—Ä–µ–≤–æ–¥–æ–≤ WordPress (`.po/.mo` —Ñ–∞–π–ª—ã) –≤–º–µ—Å—Ç–æ Polylang String Translations. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –≤ git –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç SQL –º–∏–≥—Ä–∞—Ü–∏–π.

**3.1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–æ–≤**

```
wp-content/themes/maslovka/languages/
‚îú‚îÄ‚îÄ maslovka.pot     # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–∫–ª—é—á–∏ = —Ä—É—Å—Å–∫–∏–µ —Ñ—Ä–∞–∑—ã)
‚îú‚îÄ‚îÄ en_US.po         # –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã (–∏—Å—Ö–æ–¥–Ω–∏–∫)
‚îî‚îÄ‚îÄ en_US.mo         # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª
```

**3.2. –û–±–µ—Ä–Ω—É—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–∞**

```php
// ‚ùå –î–û:
echo '–ü–æ–¥—Ä–æ–±–Ω–µ–µ';

// ‚úÖ –ü–û–°–õ–ï (—Ä—É—Å—Å–∫–∞—è —Å—Ç—Ä–æ–∫–∞ –∫–∞–∫ –∫–ª—é—á):
echo __('–ü–æ–¥—Ä–æ–±–Ω–µ–µ', 'maslovka');
// –∏–ª–∏ –¥–ª—è –≤—ã–≤–æ–¥–∞:
esc_html_e('–ü–æ–¥—Ä–æ–±–Ω–µ–µ', 'maslovka');
```

**–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```
wp-content/themes/maslovka/
‚îú‚îÄ‚îÄ 404.php, 500.php, 503.php   # –°—Ç—Ä–∞–Ω–∏—Ü—ã –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ footer.php                   # –ö—É–∫–∏-–±–∞–Ω–Ω–µ—Ä
‚îú‚îÄ‚îÄ single.php                   # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ö—É–¥–æ–∂–Ω–∏–∫–∞
‚îú‚îÄ‚îÄ single-collection.php        # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
‚îú‚îÄ‚îÄ page-artists.php             # –ê—Ä—Ö–∏–≤ —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ topmenu.php             # –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
‚îÇ   ‚îú‚îÄ‚îÄ home-events.php         # –ë–ª–æ–∫ —Å–æ–±—ã—Ç–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ home-vistavki.php       # –ë–ª–æ–∫ –≤—ã—Å—Ç–∞–≤–æ–∫
‚îî‚îÄ‚îÄ inc/components/
    ‚îú‚îÄ‚îÄ events-grid.php         # –°–µ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
    ‚îî‚îÄ‚îÄ exhibitions-grid.php    # –°–µ—Ç–∫–∞ –≤—ã—Å—Ç–∞–≤–æ–∫
```

**3.3. –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤**

–í `inc/theme/theme-setup.php`:
```php
function maslovka_theme_setup() {
    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Ç–µ–º—ã
    load_theme_textdomain('maslovka', get_template_directory() . '/languages');
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
}
```

**3.4. –ë–∏–ª–¥ –ø–µ—Ä–µ–≤–æ–¥–æ–≤**

–í `package.json` –¥–æ–±–∞–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç:
```json
{
  "scripts": {
    "build:i18n": "msgfmt languages/en_US.po -o languages/en_US.mo",
    "build": "webpack --mode production && npm run build:i18n"
  }
}
```

–¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `gettext`:
```bash
# macOS
brew install gettext

# Ubuntu/Debian
sudo apt-get install gettext
```

**3.5. –ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤**

1. –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –≤ PHP —Å `__('–¢–µ–∫—Å—Ç', 'maslovka')`
2. –î–æ–±–∞–≤–∏—Ç—å –≤ `languages/maslovka.pot` (msgid)
3. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ `languages/en_US.po` (msgstr)
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å `npm run build:i18n`
5. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –≤—Å–µ 3 —Ñ–∞–π–ª–∞ (.pot, .po, .mo)

**3.6. –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å**

–î–æ–±–∞–≤–∏—Ç—å ACF –ø–æ–ª–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü:

```php
// –í functions.php –∏–ª–∏ ACF JSON:
if (function_exists('acf_add_local_field_group')) {
    acf_add_local_field_group(array(
        'key' => 'group_page_settings',
        'title' => '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã',
        'fields' => array(
            array(
                'key' => 'field_show_language_switcher',
                'label' => '–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–æ–≤',
                'name' => 'show_language_switcher',
                'type' => 'true_false',
                'default_value' => 1,
                'ui' => 1,
            ),
        ),
        'location' => array(
            array(
                array(
                    'param' => 'post_type',
                    'operator' => '==',
                    'value' => 'page',
                ),
            ),
        ),
    ));
}
```

–í `header.php`:
```php
<?php 
if (function_exists('pll_the_languages') && get_field('show_language_switcher')) : 
?>
<div class="language-switcher">
    <?php 
    pll_the_languages(array(
        'show_flags' => 1,
        'show_names' => 0,
        'dropdown' => 0
    )); 
    ?>
</div>
<?php endif; ?>
```

CSS:
```css
.language-switcher {
    display: flex;
    gap: 10px;
}
.language-switcher a {
    opacity: 0.6;
}
.language-switcher a.current {
    opacity: 1;
}
```

**3.6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤**

**SQL-–∑–∞–ø—Ä–æ—Å—ã:**
```sql
-- 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–µ—Ä–µ–≤–æ–¥—ã —Å—Ç—Ä–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
SELECT option_name FROM wp_options WHERE option_name LIKE 'polylang_mo%';
-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∏: polylang_mo_1, polylang_mo_2 –∏ —Ç.–¥.

-- 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
SELECT COUNT(*) as total FROM wp_options WHERE option_name LIKE 'polylang_mo%';
-- –û–∂–∏–¥–∞–µ–º–æ: –º–∏–Ω–∏–º—É–º 2 –∑–∞–ø–∏—Å–∏ (–¥–ª—è RU –∏ EN)
```

**curl (–ø—Ä–æ–≤–µ—Ä–∫–∞ hreflang):**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤
curl -s https://localhost/ | grep 'hreflang='
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ ru –∏ en –≤–µ—Ä—Å–∏–∏
```

**–í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
```
1. Settings ‚Üí Languages ‚Üí String translations
   ‚úÖ –í—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ functions.php –≤–∏–¥–Ω—ã –≤ —Å–ø–∏—Å–∫–µ
   ‚úÖ –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –µ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ EN

2. –û—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞ RU
   ‚úÖ –ö–Ω–æ–ø–∫–∏ "–ü–æ–¥—Ä–æ–±–Ω–µ–µ", "–ù–∞–∑–∞–¥" –Ω–∞ —Ä—É—Å—Å–∫–æ–º

3. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ EN (/en/)
   ‚úÖ –ö–Ω–æ–ø–∫–∏ "Read more", "Back" –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º

4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —è–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
   ‚úÖ –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å ACF field = true –≤–∏–¥–µ–Ω –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
   ‚úÖ –ö–ª–∏–∫ –ø–æ EN –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –Ω–∞ /en/
```

**–ß–µ–∫-–ª–∏—Å—Ç –§–∞–∑—ã 3:**
- [ ] –í—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–µ–º—ã –æ–±–µ—Ä–Ω—É—Ç—ã –≤ `pll__()`
- [ ] Settings ‚Üí String translations –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏
- [ ] –ü–µ—Ä–µ–≤–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∞–¥–º–∏–Ω–∫–µ (–Ω–∞ LOCAL)
- [ ] –í–∏–∑—É–∞–ª—å–Ω–æ RU/EN –≤–µ—Ä—Å–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è 002 —Å–æ–∑–¥–∞–Ω–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞
- [ ] –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] ACF field –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å—é
- [ ] Git commit –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–µ–º—ã

---

### –§–∞–∑–∞ 4: –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤ - 1-2 —á–∞—Å–∞

**4.1. –ü–ª–∞–≥–∏–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤**

```
wp-content/plugins/maslovka-polylang-redirects/
‚îú‚îÄ‚îÄ maslovka-polylang-redirects.php
‚îî‚îÄ‚îÄ readme.txt
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** 301 —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å `/en/slug/` –Ω–∞ `/en/slug-2/` (–∫–æ–≥–¥–∞ slug'–∏ —Ä–∞–∑–Ω—ã–µ)

**–ö–ª—é—á–µ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
- Hook –Ω–∞ `template_redirect`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —è–∑—ã–∫–∞ (`pll_current_language()`)
- –ü–æ–∏—Å–∫ –ø–µ—Ä–µ–≤–æ–¥–∞ —á–µ—Ä–µ–∑ `pll_get_post()`
- –†–µ–¥–∏—Ä–µ–∫—Ç 301

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏:
  - maslovka-redirects
  - maslovka-transliterator
- ‚úÖ –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∞–¥–º–∏–Ω–∫—É
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö CPT

**4.2. –ü–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è**

```
wp-content/plugins/maslovka-polylang-duplicator/
‚îú‚îÄ‚îÄ maslovka-polylang-duplicator.php
‚îî‚îÄ‚îÄ readme.txt
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–∞

**–ß—Ç–æ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è:**
- ‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫ (title)
- ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç (content)
- ‚úÖ Excerpt
- ‚úÖ Featured image
- ‚úÖ ACF –ø–æ–ª—è
- ‚úÖ –¢–µ—Ä–º–∏–Ω—ã —Ç–∞–∫—Å–æ–Ω–æ–º–∏–π

**–õ–æ–≥–∏–∫–∞:**
- Hook –Ω–∞ `save_post`
- –ü—Ä–æ–≤–µ—Ä–∫–∞: —ç—Ç–æ –Ω–æ–≤—ã–π –ø–µ—Ä–µ–≤–æ–¥?
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –ø–æ—Å—Ç–∞
- –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å ACF Pro
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏
- ‚úÖ –ù–µ –¥—É–±–ª–∏—Ä—É–µ—Ç –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ—Å—Ç–∞
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–∑–¥–∞–Ω–∏–∏

**4.3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤**

```bash
# –ù–∞ LOCAL:
cd www/wordpress/wp-content/plugins

# –°–æ–∑–¥–∞—Ç—å –ø–ª–∞–≥–∏–Ω—ã (—Å–º. –ø–æ–ª–Ω—ã–π –∫–æ–¥ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ö–æ–¥ –ø–ª–∞–≥–∏–Ω–æ–≤")

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å:
# WordPress Admin ‚Üí Plugins ‚Üí Activate
# - Maslovka Polylang Redirects
# - Maslovka Polylang Duplicator

# Git commit:
git add wp-content/plugins/maslovka-polylang-*
git commit -m "feat: add Polylang custom plugins"
```

**4.4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–æ–≤**

**–¢–µ—Å—Ç 1: –ü–ª–∞–≥–∏–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤**

**–í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ:**
```
1. Plugins ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ maslovka-polylang-redirects –∞–∫—Ç–∏–≤–µ–Ω
2. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ—Å—Ç –Ω–∞ RU
3. –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥ —á–µ—Ä–µ–∑ Languages ‚Üí + English
4. Polylang –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç EN –≤–µ—Ä—Å–∏—é —Å slug-2
```

**curl (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞):**
```bash
# –ï—Å–ª–∏ RU –ø–æ—Å—Ç –∏–º–µ–µ—Ç slug "test-post", EN –≤–µ—Ä—Å–∏—è –±—É–¥–µ—Ç "test-post-2"
# –†–µ–¥–∏—Ä–µ–∫—Ç —Å /en/test-post/ –¥–æ–ª–∂–µ–Ω –≤–µ—Å—Ç–∏ –Ω–∞ /en/test-post-2/
curl -I https://localhost/en/test-post/ 2>&1 | grep -E "HTTP|location"
# –û–∂–∏–¥–∞–µ–º–æ:
# HTTP/2 301
# location: https://localhost/en/test-post-2/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
curl -I https://localhost/en/test-post-2/ 2>&1 | grep HTTP
# –û–∂–∏–¥–∞–µ–º–æ: HTTP/2 200
```

**–¢–µ—Å—Ç 2: –ü–ª–∞–≥–∏–Ω –¥—É–ø–ª–∏–∫–∞—Ç–æ—Ä–∞**

**–í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
```
1. –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É:
   - –ó–∞–≥–æ–ª–æ–≤–æ–∫: "–¢–µ—Å—Ç"
   - –ö–æ–Ω—Ç–µ–Ω—Ç: "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ"
   - Featured image: –∑–∞–≥—Ä—É–∑–∏—Ç—å
   - ACF –ø–æ–ª—è: –∑–∞–ø–æ–ª–Ω–∏—Ç—å

2. –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥: Languages ‚Üí + English
   ‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª—Å—è
   ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª—Å—è
   ‚úÖ Featured image –Ω–∞ –º–µ—Å—Ç–µ
   ‚úÖ ACF –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
   - –û—Ç–∫—Ä—ã—Ç—å /en/test/ 
   ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /en/test-2/
   ‚úÖ –ù–µ—Ç 404 –æ—à–∏–±–∫–∏
```

**SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑—å –ø–µ—Ä–µ–≤–æ–¥–æ–≤
SELECT tr.object_id, t.slug as lang, p.post_title
FROM wp_term_relationships tr
JOIN wp_term_taxonomy tt ON tr.term_taxonomy_id = tt.term_taxonomy_id
JOIN wp_terms t ON tt.term_id = t.term_id
JOIN wp_posts p ON tr.object_id = p.ID
WHERE tt.taxonomy = 'language' AND p.post_type = 'post'
ORDER BY p.post_title, t.slug;
```

**–ß–µ–∫-–ª–∏—Å—Ç –§–∞–∑—ã 4:**
- [ ] –ü–ª–∞–≥–∏–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
- [ ] –¢–µ—Å—Ç curl —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –ø—Ä–æ—à–µ–ª (301 ‚Üí –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL)
- [ ] –ü–ª–∞–≥–∏–Ω –¥—É–ø–ª–∏–∫–∞—Ç–æ—Ä–∞ —Å–æ–∑–¥–∞–Ω –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω  
- [ ] –¢–µ—Å—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø—Ä–æ—à–µ–ª (–≤–∏–∑—É–∞–ª—å–Ω–æ)
- [ ] –¢–µ—Å—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è ACF –ø–æ–ª–µ–π –ø—Ä–æ—à–µ–ª
- [ ] –¢–µ—Å—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è featured image –ø—Ä–æ—à–µ–ª
- [ ] –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å maslovka-redirects
- [ ] –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å maslovka-transliterator
- [ ] Git commit –ø–ª–∞–≥–∏–Ω–æ–≤

---

### –§–∞–∑–∞ 5: –î–µ–º–æ-–∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - 1 —á–∞—Å

**5.1. –°–æ–∑–¥–∞—Ç—å –¥–µ–º–æ-–ø–æ—Å—Ç—ã**

**5.2. –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã**

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞:
1. –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç ‚Üí Languages ‚Üí + (Add new translation)
2. –ü–ª–∞–≥–∏–Ω Duplicator –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–æ–ø–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç
3. –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ACF –ø–æ–ª—è (–¥–æ–ª–∂–Ω—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å—Å—è)
5. Publish

**5.3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

```
‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
- –†–µ–¥–∏—Ä–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç?
- ACF –ø–æ–ª—è –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã?
- Featured image –Ω–∞ –º–µ—Å—Ç–µ?
- –¢–µ—Ä–º–∏–Ω—ã —Ç–∞–∫—Å–æ–Ω–æ–º–∏–π —Å–≤—è–∑–∞–Ω—ã?
```

**5.4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –¥–µ–º–æ-–∫–æ–Ω—Ç–µ–Ω—Ç–µ**

**SQL-–∑–∞–ø—Ä–æ—Å—ã:**
```sql
-- 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤ –ø–æ —è–∑—ã–∫–∞–º
SELECT t.slug as lang, COUNT(*) as count
FROM wp_posts p
JOIN wp_term_relationships tr ON p.ID = tr.object_id
JOIN wp_term_taxonomy tt ON tr.term_taxonomy_id = tt.term_taxonomy_id
JOIN wp_terms t ON tt.term_id = t.term_id
WHERE tt.taxonomy = 'language' AND p.post_type = 'post' AND p.post_status = 'publish'
GROUP BY t.slug;
-- –û–∂–∏–¥–∞–µ–º–æ: ru –∏ en —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º

-- 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
SELECT 
    ru_post.post_title as ru_title,
    en_post.post_title as en_title
FROM wp_term_relationships tr_ru
JOIN wp_posts ru_post ON tr_ru.object_id = ru_post.ID
JOIN wp_term_taxonomy tt_trans ON tr_ru.term_taxonomy_id = tt_trans.term_taxonomy_id
JOIN wp_term_relationships tr_en ON tr_en.term_taxonomy_id = tt_trans.term_taxonomy_id
JOIN wp_posts en_post ON tr_en.object_id = en_post.ID
WHERE tt_trans.taxonomy = 'post_translations'
  AND ru_post.ID != en_post.ID
LIMIT 10;
```

**curl (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤):**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ URL
for SLUG in "test-post" "sample-article"; do
  CODE=$(curl -s -o /dev/null -w "%{http_code}" "https://localhost/en/$SLUG/")
  echo "/en/$SLUG/ - $CODE"
done
# 301 = —Ä–µ–¥–∏—Ä–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, 200 = –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø, 404 = –ø—Ä–æ–±–ª–µ–º–∞
```

**–í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
```
1. –û—Ç–∫—Ä—ã—Ç—å Posts ‚Üí All Posts
   ‚úÖ –í–∏–¥–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ —Å —Ñ–ª–∞–≥–∞–º–∏ —è–∑—ã–∫–æ–≤
   ‚úÖ –£ –∫–∞–∂–¥–æ–≥–æ RU –ø–æ—Å—Ç–∞ –µ—Å—Ç—å EN –ø–µ—Ä–µ–≤–æ–¥ (—Ñ–ª–∞–≥)

2. –û—Ç–∫—Ä—ã—Ç—å –ª—é–±–æ–π EN –ø–æ—Å—Ç
   ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω
   ‚úÖ Featured image –Ω–∞ –º–µ—Å—Ç–µ
   ‚úÖ ACF –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã

3. –û—Ç–∫—Ä—ã—Ç—å EN –ø–æ—Å—Ç –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
   ‚úÖ URL: /en/post-name-2/
   ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
   ‚úÖ –ù–µ—Ç PHP –æ—à–∏–±–æ–∫

4. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL
   ‚úÖ /en/post-name/ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç 301 –Ω–∞ /en/post-name-2/
```

**–ß–µ–∫-–ª–∏—Å—Ç –§–∞–∑—ã 5:**
- [ ] –î–µ–º–æ-–∫–æ–Ω—Ç–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –Ω–∞ –æ–±–æ–∏—Ö —è–∑—ã–∫–∞—Ö
- [ ] –í—Å–µ RU –ø–æ—Å—Ç—ã –∏–º–µ—é—Ç EN –ø–µ—Ä–µ–≤–æ–¥—ã (–≤–∏–¥–Ω–æ –ø–æ —Ñ–ª–∞–≥–∞–º)
- [ ] ACF –ø–æ–ª—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã —É EN –ø–æ—Å—Ç–æ–≤
- [ ] Featured images –Ω–∞ –º–µ—Å—Ç–µ
- [ ] –¢–µ—Å—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ –ø—Ä–æ—à–µ–ª
- [ ] –í–∏–∑—É–∞–ª—å–Ω–æ EN –ø–æ—Å—Ç—ã –≤—ã–≥–ª—è–¥—è—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ù–µ—Ç PHP –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö

---

### –§–∞–∑–∞ 6: SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–Ω–∞ LOCAL) - 1-2 —á–∞—Å–∞

**6.1. Hreflang —Ç–µ–≥–∏**

–í `header.php`:
```php
<?php if (function_exists('pll_the_languages')) : ?>
    <?php foreach (pll_the_languages(array('raw' => 1)) as $lang) : ?>
        <link rel="alternate" hreflang="<?php echo $lang['slug']; ?>" 
              href="<?php echo $lang['url']; ?>" />
    <?php endforeach; ?>
    <link rel="alternate" hreflang="x-default" 
          href="<?php echo pll_home_url('ru'); ?>" />
<?php endif; ?>
```

**6.2. Canonical —Ç–µ–≥–∏**

```php
<?php if (function_exists('pll_current_language')) : ?>
    <link rel="canonical" href="<?php echo get_permalink(); ?>" />
<?php endif; ?>
```

**6.3. XML Sitemap**

```php
// –í functions.php
function maslovka_polylang_sitemap() {
    if (function_exists('pll_the_languages')) {
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è sitemap —Å hreflang
        // –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Yoast SEO —Å Polylang
    }
}
```

**6.4. Open Graph**

```php
<meta property="og:locale" content="<?php echo pll_current_language('locale'); ?>" />
<?php foreach (pll_the_languages(array('raw' => 1)) as $lang) : ?>
    <?php if ($lang['slug'] != pll_current_language()) : ?>
        <meta property="og:locale:alternate" content="<?php echo $lang['locale']; ?>" />
    <?php endif; ?>
<?php endforeach; ?>
```

**6.5. Google Analytics**

```js
// –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —è–∑—ã–∫–∞
gtag('config', 'G-XXXXXXXXXX', {
  'custom_map': {'dimension1': 'language'}
});
gtag('event', 'page_view', {
  'language': '<?php echo pll_current_language(); ?>'
});
```

**6.6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SEO**

**curl (–ø—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–∞-—Ç–µ–≥–æ–≤):**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å hreflang —Ç–µ–≥–∏
curl -s https://localhost/ | grep 'hreflang='
# –û–∂–∏–¥–∞–µ–º–æ:
# <link rel="alternate" hreflang="ru" href="https://localhost/" />
# <link rel="alternate" hreflang="en" href="https://localhost/en/" />
# <link rel="alternate" hreflang="x-default" href="https://localhost/" />

curl -s https://localhost/en/ | grep 'hreflang=' | wc -l
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 3 —Ç–µ–≥–∞

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å canonical —Ç–µ–≥–∏
curl -s https://localhost/ | grep 'rel="canonical"'
# –û–∂–∏–¥–∞–µ–º–æ: <link rel="canonical" href="https://localhost/" />

curl -s https://localhost/en/ | grep 'rel="canonical"'
# –û–∂–∏–¥–∞–µ–º–æ: <link rel="canonical" href="https://localhost/en/" />

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Open Graph locale
curl -s https://localhost/ | grep 'og:locale'
# –û–∂–∏–¥–∞–µ–º–æ:
# <meta property="og:locale" content="ru_RU" />
# <meta property="og:locale:alternate" content="en_US" />

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å HTML lang –∞—Ç—Ä–∏–±—É—Ç
curl -s https://localhost/ | grep '<html' | grep 'lang='
# –û–∂–∏–¥–∞–µ–º–æ: <html lang="ru-RU">

curl -s https://localhost/en/ | grep '<html' | grep 'lang='
# –û–∂–∏–¥–∞–µ–º–æ: <html lang="en-US">
```

**–í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
```
1. Chrome DevTools ‚Üí Elements ‚Üí <head>
   ‚úÖ hreflang —Ç–µ–≥–∏ –≤–∏–¥–Ω—ã (3+)
   ‚úÖ canonical —Ç–µ–≥ –≤–∏–¥–µ–Ω
   ‚úÖ og:locale –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω

2. View Page Source (Ctrl+U)
   ‚úÖ <html lang="..."> —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —è–∑—ã–∫—É
```

**–ß–µ–∫-–ª–∏—Å—Ç –§–∞–∑—ã 6:**
- [ ] curl | grep hreflang –Ω–∞—Ö–æ–¥–∏—Ç 3+ —Ç–µ–≥–∞
- [ ] Hreflang ru, en, x-default –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
- [ ] Canonical —Ç–µ–≥–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ URL
- [ ] og:locale –º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è RU/EN
- [ ] HTML lang –∞—Ç—Ä–∏–±—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- [ ] Git commit SEO –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

### –§–∞–∑–∞ 7: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ DEV - 30 –º–∏–Ω—É—Ç

**6.1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**

```bash
# –ù–∞ LOCAL:
git add .
git commit -m "feat: complete Polylang setup with migrations"
git push origin polylang
```

**6.2. –î–µ–ø–ª–æ–π –Ω–∞ DEV**

```bash
# –ù–∞ DEV —Å–µ—Ä–≤–µ—Ä–µ:
cd /var/www/dev.maslovka.org
git pull origin polylang

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Polylang –≤—Ä—É—á–Ω—É—é:
# WordPress Admin ‚Üí Plugins ‚Üí Upload polylang.zip ‚Üí Activate

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:
cd www/deployment-scripts/database
./db-migrate.sh apply dev

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã:
# WordPress Admin ‚Üí Plugins ‚Üí Activate
# - Maslovka Polylang Redirects
# - Maslovka Polylang Duplicator

# Flush permalinks:
# Settings ‚Üí Permalinks ‚Üí Save Changes
```

**6.3. –ü—Ä–æ–≤–µ—Ä–∫–∞**

```
‚úÖ –Ø–∑—ã–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã?
‚úÖ CPT –≤–∫–ª—é—á–µ–Ω—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞?
‚úÖ –ú–µ–Ω—é —Å–æ–∑–¥–∞–Ω—ã?
‚úÖ –°—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã?
‚úÖ –ü–ª–∞–≥–∏–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç?
```

**7.4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ DEV**

**curl (–≤–Ω–µ—à–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞):**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –æ–±–µ–∏—Ö –≤–µ—Ä—Å–∏–π
curl -I https://dev.maslovka.org/ 2>&1 | grep HTTP
# –û–∂–∏–¥–∞–µ–º–æ: HTTP/2 200

curl -I https://dev.maslovka.org/en/ 2>&1 | grep HTTP
# –û–∂–∏–¥–∞–µ–º–æ: HTTP/2 200

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å hreflang —Ç–µ–≥–∏
curl -s https://dev.maslovka.org/ | grep hreflang | wc -l
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 3+

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç
curl -I https://dev.maslovka.org/en/test-post/ 2>&1 | grep -E "HTTP|location"
# –ï—Å–ª–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω: HTTP/2 301
```

**Smoke tests (—á–µ—Ä–µ–∑ deployment scripts):**
```bash
cd www/deployment-scripts
./smoke-tests.sh dev
# –û–∂–∏–¥–∞–µ–º–æ: All tests passed
```

**–í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ DEV:**
```
1. –û—Ç–∫—Ä—ã—Ç—å https://dev.maslovka.org/
   ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
   ‚úÖ –ù–µ—Ç PHP –æ—à–∏–±–æ–∫
   ‚úÖ –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∏–¥–µ–Ω (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)

2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ EN
   ‚úÖ URL –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ /en/
   ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
   ‚úÖ –ü–µ—Ä–µ–≤–æ–¥—ã —Å—Ç—Ä–æ–∫ —Ä–∞–±–æ—Ç–∞—é—Ç

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ–Ω—é
   ‚úÖ –ù–∞ RU - —Ä—É—Å—Å–∫–æ–µ –º–µ–Ω—é
   ‚úÖ –ù–∞ EN - –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ –º–µ–Ω—é

4. –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç –Ω–∞ EN
   ‚úÖ URL –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
   ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
   ‚úÖ ACF –ø–æ–ª—è –Ω–∞ –º–µ—Å—Ç–µ
```

**–ß–µ–∫-–ª–∏—Å—Ç –§–∞–∑—ã 7:**
- [ ] Git pull –Ω–∞ DEV –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] Polylang –∞–∫—Ç–∏–≤–µ–Ω (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∞–¥–º–∏–Ω–∫–µ)
- [ ] –Ø–∑—ã–∫–∏ —Å–æ–∑–¥–∞–Ω—ã: ru (default), en
- [ ] –ú–µ–Ω—é —Å–æ–∑–¥–∞–Ω—ã –Ω–∞ –æ–±–æ–∏—Ö —è–∑—ã–∫–∞—Ö
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã (–º–µ–Ω—é + –ø–µ—Ä–µ–≤–æ–¥—ã)
- [ ] –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã
- [ ] Permalinks –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- [ ] https://dev.maslovka.org/ –¥–æ—Å—Ç—É–ø–Ω–∞ (curl -I ‚Üí 200)
- [ ] https://dev.maslovka.org/en/ –¥–æ—Å—Ç—É–ø–Ω–∞ (curl -I ‚Üí 200)
- [ ] Smoke tests –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ PHP/Nginx –ª–æ–≥–∞—Ö
- [ ] –í–∏–∑—É–∞–ª—å–Ω–æ DEV —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### –§–∞–∑–∞ 8: –î–µ–ø–ª–æ–π –Ω–∞ PROD - 1 —á–∞—Å

**8.1. –§–∏–Ω–∞–ª—å–Ω—ã–π –¥–µ–ø–ª–æ–π**

```bash
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è:
cd www/deployment-scripts
./deploy-prod.sh

# –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# ‚úÖ –°–æ–∑–¥–∞—Å—Ç –±—ç–∫–∞–ø –ë–î –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
# ‚úÖ –°–¥–µ–ª–∞–µ—Ç git pull –Ω–∞ PROD —Å–µ—Ä–≤–µ—Ä–µ
# ‚úÖ –û–±–Ω–æ–≤–∏—Ç —Ñ–∞–π–ª—ã —Ç–µ–º—ã
# ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
# ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç smoke tests
# ‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
```

**8.2. –†—É—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è**

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Polylang –≤—Ä—É—á–Ω—É—é:
# WordPress Admin ‚Üí Plugins ‚Üí Upload polylang.zip ‚Üí Activate

# 2. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã:
# WordPress Admin ‚Üí Plugins ‚Üí Activate
# - Maslovka Polylang Redirects
# - Maslovka Polylang Duplicator

# 3. Flush permalinks:
# Settings ‚Üí Permalinks ‚Üí Save Changes
```

**8.3. –ü—Ä–æ–≤–µ—Ä–∫–∞**

```
‚úÖ –Ø–∑—ã–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã?
‚úÖ CPT –≤–∫–ª—é—á–µ–Ω—ã?
‚úÖ –ú–µ–Ω—é —Å–æ–∑–¥–∞–Ω—ã?
‚úÖ –°—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã?
‚úÖ –ü–ª–∞–≥–∏–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç?
‚úÖ SEO —Ç–µ–≥–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã?
‚úÖ Smoke tests passed?
‚úÖ –ë—ç–∫–∞–ø —Å–æ–∑–¥–∞–Ω?
```

**8.4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ PROD**

**Pre-deployment –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å pre-deployment checklist
cd www/deployment-scripts
./pre-deployment-checklist.sh
# –í—Å–µ –ø—É–Ω–∫—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å ‚úì

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±—ç–∫–∞–ø —Å–æ–∑–¥–∞–Ω
ls -lh www/backups/snapshots/ | tail -5
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–≤–µ–∂–∏–π snapshot
```

**Post-deployment –ø—Ä–æ–≤–µ—Ä–∫–∏ (curl):**
```bash
# 1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
for URL in "/" "/en/" "/about/"; do
  CODE=$(curl -s -o /dev/null -w "%{http_code}" "https://maslovka.org$URL")
  echo "$URL - $CODE"
done
# –í—Å–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å 200

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å hreflang –Ω–∞ PROD
curl -s https://maslovka.org/ | grep hreflang | wc -l
# –ú–∏–Ω–∏–º—É–º 3

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
curl -I https://maslovka.org/en/test-post/ 2>&1 | grep -E "HTTP|location"
# HTTP/2 301 (–µ—Å–ª–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
```

**Smoke tests:**
```bash
cd www/deployment-scripts
./smoke-tests.sh prod
# –û–∂–∏–¥–∞–µ–º–æ: All tests passed ‚úì
```
# location: /en/test-post-2/
```

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
curl -w "Total: %{time_total}s\n" -o /dev/null -s https://maslovka.org/
# time_total –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å < 2 —Å–µ–∫—É–Ω–¥
```

**–í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ PROD:**
```
1. –û—Ç–∫—Ä—ã—Ç—å https://maslovka.org/
   ‚úÖ –ì–ª–∞–≤–Ω–∞—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
   ‚úÖ –ù–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –±–∞–≥–æ–≤
   ‚úÖ –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç

2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ EN
   ‚úÖ URL: https://maslovka.org/en/
   ‚úÖ –ü–µ—Ä–µ–≤–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
   ‚úÖ –ú–µ–Ω—é –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º

3. –û—Ç–∫—Ä—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å—Ç–æ–≤
   ‚úÖ RU –ø–æ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
   ‚úÖ EN –ø–æ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
   ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SEO (View Page Source)
   ‚úÖ hreflang —Ç–µ–≥–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
   ‚úÖ canonical —Ç–µ–≥–∏ –Ω–∞ –º–µ—Å—Ç–µ
   ‚úÖ og:locale –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
```

**–†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```
–ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
‚ñ° –ì–ª–∞–≤–Ω–∞—è (/, /en/)
‚ñ° –û –º—É–∑–µ–µ
‚ñ° –ö–æ–ª–ª–µ–∫—Ü–∏–∏
‚ñ° –í—ã—Å—Ç–∞–≤–∫–∏
‚ñ° –°–æ–±—ã—Ç–∏—è
‚ñ° –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –∫–∞–∂–¥–æ–π:
‚ñ° RU –≤–µ—Ä—Å–∏—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è (200)
‚ñ° EN –≤–µ—Ä—Å–∏—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è (200)
‚ñ° –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚ñ° –§–æ—Ä–º—ã, –ø–æ–∏—Å–∫, –≥–∞–ª–µ—Ä–µ–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
```

**Rollback (–µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã):**
```bash
cd www/deployment-scripts
./rollback.sh
```

**–ß–µ–∫-–ª–∏—Å—Ç –§–∞–∑—ã 8:**
- [ ] Pre-deployment checklist –ø—Ä–æ–π–¥–µ–Ω
- [ ] –ë—ç–∫–∞–ø –ë–î —Å–æ–∑–¥–∞–Ω
- [ ] `./deploy-prod.sh` –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
- [ ] Polylang –∞–∫—Ç–∏–≤–µ–Ω –Ω–∞ PROD (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∞–¥–º–∏–Ω–∫–µ)
- [ ] –Ø–∑—ã–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã: ru (default), en
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã (–º–µ–Ω—é + –ø–µ—Ä–µ–≤–æ–¥—ã)
- [ ] –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã
- [ ] https://maslovka.org/ –¥–æ—Å—Ç—É–ø–Ω–∞ (curl ‚Üí 200)
- [ ] https://maslovka.org/en/ –¥–æ—Å—Ç—É–ø–Ω–∞ (curl ‚Üí 200)
- [ ] Smoke tests –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] Hreflang —Ç–µ–≥–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [ ] –†–µ–¥–∏—Ä–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –í–∏–∑—É–∞–ª—å–Ω–æ PROD —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ

---

### –§–∞–∑–∞ 9: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ - 1 —á–∞—Å

**9.1. –°–æ–∑–¥–∞—Ç—å –≥–∞–π–¥ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤**

```markdown
# –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥

1. –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º
2. –í –º–µ—Ç–∞–±–æ–∫—Å–µ Languages –Ω–∞–∂–∞—Ç—å + —Ä—è–¥–æ–º —Å English
3. –ö–æ–Ω—Ç–µ–Ω—Ç —Å–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚úÖ
4. –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ACF –ø–æ–ª—è
6. Publish

# –ö–∞–∫ —Å–≤—è–∑–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ—Å—Ç—ã

1. –û—Ç–∫—Ä—ã—Ç—å —Ä—É—Å—Å–∫–∏–π –ø–æ—Å—Ç
2. Languages ‚Üí Select existing translation
3. –í—ã–±—Ä–∞—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –ø–æ—Å—Ç
4. Save

# –ö–∞–∫ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ—Ä–º–∏–Ω —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏

1. Categories ‚Üí –í—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
2. Languages ‚Üí + English
3. –í–≤–µ—Å—Ç–∏ –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è
4. Update
```

**9.2. –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤**

```
‚ñ° –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
‚ñ° –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç
‚ñ° –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ excerpt
‚ñ° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ACF –ø–æ–ª—è (–¥–∞—Ç—ã, —á–∏—Å–ª–∞)
‚ñ° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏/—Ç–µ–≥–∏ (–ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã?)
‚ñ° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å featured image
‚ñ° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–µ–≤—å—é
‚ñ° Publish
```

**–ß–µ–∫-–ª–∏—Å—Ç –§–∞–∑—ã 9:**
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ö–æ–Ω—Ç–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä—ã –æ–±—É—á–µ–Ω—ã
- [ ] –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω

---

## üì¶ SQL –ú–∏–≥—Ä–∞—Ü–∏–∏ (–ø–æ–ª–Ω—ã–π –∫–æ–¥)

### –ú–∏–≥—Ä–∞—Ü–∏—è 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —è–∑—ã–∫–æ–≤

**–§–∞–π–ª:** `001-polylang-setup-languages.sql`

```sql
-- ================================================================
-- Polylang: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —è–∑—ã–∫–æ–≤ RU + EN
-- ================================================================
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ Polylang –µ—â–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
-- ================================================================

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —è–∑—ã–∫–∞ RU (–µ—Å–ª–∏ –µ—Å—Ç—å - –º–∏–≥—Ä–∞—Ü–∏—è —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞)
SET @lang_exists = (SELECT COUNT(*) FROM wp_term_taxonomy WHERE taxonomy = 'language' AND description LIKE '%ru_RU%');

-- –í—ã–ø–æ–ª–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —è–∑—ã–∫–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω—ã
SET @skip_migration = IF(@lang_exists > 0, 'SELECT "Migration already applied, skipping..."', 'SELECT "Applying migration..."');
PREPARE stmt FROM @skip_migration;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;

-- –ï—Å–ª–∏ —è–∑—ã–∫–∏ —É–∂–µ –µ—Å—Ç—å, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é
DROP PROCEDURE IF EXISTS apply_polylang_languages;
DELIMITER $$
CREATE PROCEDURE apply_polylang_languages()
BEGIN
    DECLARE lang_exists INT;
    
    SELECT COUNT(*) INTO lang_exists 
    FROM wp_term_taxonomy 
    WHERE taxonomy = 'language' AND description LIKE '%ru_RU%';
    
    IF lang_exists = 0 THEN
        -- –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–µ—Å–ª–∏ –±—ã–ª–∏)
        DELETE FROM wp_options WHERE option_name LIKE 'polylang%';

INSERT INTO wp_options (option_name, option_value, autoload) VALUES
('polylang', 'a:13:{s:7:"browser";i:1;s:8:"rewrite";i:1;s:10:"hide_default";i:1;s:13:"force_lang";i:0;s:8:"redirect_lang";i:0;s:13:"media_support";i:1;s:12:"uninstall";i:0;s:7:"sync";a:0:{}s:10:"post_types";a:0:{}s:10:"taxonomies";a:0:{}s:7:"domains";a:0:{}s:7:"version";s:5:"3.5.0";s:11:"first_activation";i:1733270400;}', 'yes');

-- –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
INSERT INTO wp_terms (name, slug, term_group) VALUES ('–†—É—Å—Å–∫–∏–π', 'ru', 0);
SET @ru_term_id = LAST_INSERT_ID();

INSERT INTO wp_term_taxonomy (term_id, taxonomy, description, parent, count) VALUES
(@ru_term_id, 'language', 'a:5:{s:6:"locale";s:5:"ru_RU";s:3:"rtl";i:0;s:4:"flag";s:2:"ru";s:4:"term_group";i:1;s:11:"flag_code";s:0:"";}', 0, 0);

-- –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
INSERT INTO wp_terms (name, slug, term_group) VALUES ('English', 'en', 0);
SET @en_term_id = LAST_INSERT_ID();

INSERT INTO wp_term_taxonomy (term_id, taxonomy, description, parent, count) VALUES
(@en_term_id, 'language', 'a:5:{s:6:"locale";s:5:"en_US";s:3:"rtl";i:0;s:4:"flag";s:2:"us";s:4:"term_group";i:2;s:11:"flag_code";s:0:"";}', 0, 0);

INSERT INTO wp_options (option_name, option_value, autoload) VALUES
('pll_languages_list', CONCAT('a:2:{i:0;i:', @ru_term_id, ';i:1;i:', @en_term_id, ';}'), 'yes'),
('pll_default_language', CONCAT('s:2:"ru";'), 'yes');

-- –¢–∞–∫—Å–æ–Ω–æ–º–∏–∏ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
INSERT INTO wp_terms (name, slug, term_group) VALUES ('pll_post_translations', 'pll_post_translations', 0);
SET @post_trans_id = LAST_INSERT_ID();

INSERT INTO wp_term_taxonomy (term_id, taxonomy, description, parent, count) VALUES
(@post_trans_id, 'post_translations', '', 0, 0);

INSERT INTO wp_terms (name, slug, term_group) VALUES ('pll_term_translations', 'pll_term_translations', 0);
SET @term_trans_id = LAST_INSERT_ID();

INSERT INTO wp_term_taxonomy (term_id, taxonomy, description, parent, count) VALUES
(@term_trans_id, 'term_translations', '', 0, 0);
    END IF;
END$$
DELIMITER ;

-- –í—ã–∑—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–¥—É—Ä—É
CALL apply_polylang_languages();
DROP PROCEDURE IF EXISTS apply_polylang_languages();

-- ================================================================
-- –í–ê–ñ–ù–û: LAST_INSERT_ID() –∏ —Ä–∞–∑–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
-- ================================================================
-- LAST_INSERT_ID() –±–µ–∑–æ–ø–∞—Å–µ–Ω! –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ID –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π
-- –∑–∞–ø–∏—Å–∏ –≤ –¢–ï–ö–£–©–ï–ô —Å–µ—Å—Å–∏–∏. –ö–∞–∂–¥–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (local/dev/prod) –∏–º–µ–µ—Ç
-- —Å–≤–æ—é –ë–î —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é ID.
-- 
-- –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞—Å—Ç —è–∑—ã–∫–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ ID –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö:
-- - LOCAL: ru_term_id=45, en_term_id=46
-- - DEV:   ru_term_id=52, en_term_id=53  
-- - PROD:  ru_term_id=128, en_term_id=129
-- 
-- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! Polylang —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ slug'–∞–º–∏ ('ru', 'en'),
-- –∞ –Ω–µ —Å ID. –ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –Ω–µ –±—É–¥–µ—Ç.
-- ================================================================
```
DROP PROCEDURE IF EXISTS apply_polylang_languages;

-- ================================================================
-- –í–ê–ñ–ù–û: LAST_INSERT_ID() –∏ —Ä–∞–∑–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
-- ================================================================
-- LAST_INSERT_ID() –±–µ–∑–æ–ø–∞—Å–µ–Ω! –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ID –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π
-- –∑–∞–ø–∏—Å–∏ –≤ –¢–ï–ö–£–©–ï–ô —Å–µ—Å—Å–∏–∏. –ö–∞–∂–¥–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (local/dev/prod) –∏–º–µ–µ—Ç
-- —Å–≤–æ—é –ë–î —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é ID.
-- 
-- –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞—Å—Ç —è–∑—ã–∫–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ ID –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö:
-- - LOCAL: ru_term_id=45, en_term_id=46
-- - DEV:   ru_term_id=52, en_term_id=53  
-- - PROD:  ru_term_id=128, en_term_id=129
-- 
-- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! Polylang —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ slug'–∞–º–∏ ('ru', 'en'),
-- –∞ –Ω–µ —Å ID. –ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –Ω–µ –±—É–¥–µ—Ç.
-- ================================================================
```

---

### ~~–ú–∏–≥—Ä–∞—Ü–∏—è 2: –í–∫–ª—é—á–µ–Ω–∏–µ CPT~~ (–ù–ï –ù–£–ñ–ù–ê)

> ‚ö†Ô∏è **–≠—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏—è –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø.** CPT –∏ —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è **–≤—Ä—É—á–Ω—É—é** –≤ –∞–¥–º–∏–Ω–∫–µ –Ω–∞ –∫–∞–∂–¥–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏ (—Å–º. –§–∞–∑—É 1.3). –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ, —á–µ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
>
> –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ PHP —Ö—É–∫ –≤ –ø–ª–∞–≥–∏–Ω–µ –≤–º–µ—Å—Ç–æ SQL:
> ```php
> add_action('init', function() {
>     if (function_exists('pll_register_post_type')) {
>         pll_register_post_type('artist');
>         pll_register_post_type('collection');
>         // –∏ —Ç.–¥.
>     }
> });
> ```

---

## üîß –ö–æ–¥ –ø–ª–∞–≥–∏–Ω–æ–≤

### –ü–ª–∞–≥–∏–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤

**–§–∞–π–ª:** `wp-content/plugins/maslovka-polylang-redirects/maslovka-polylang-redirects.php`

```php
<?php
/**
 * Plugin Name: Maslovka Polylang Redirects
 * Description: 301 —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö URL –º–µ–∂–¥—É —è–∑—ã–∫–∞–º–∏
 * Version: 1.0
 * Author: Maslovka Team
 */

if (!defined('ABSPATH')) exit;

class Maslovka_Polylang_Redirects {
    
    public function __construct() {
        add_action('template_redirect', array($this, 'handle_redirects'));
    }
    
    public function handle_redirects() {
        // –¢–æ–ª—å–∫–æ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
        if (is_admin() || !function_exists('pll_current_language')) {
            return;
        }
        
        // –¢–æ–ª—å–∫–æ –¥–ª—è 404
        if (!is_404()) {
            return;
        }
        
        $current_lang = pll_current_language();
        $request_uri = $_SERVER['REQUEST_URI'];
        
        // –£–±—Ä–∞—Ç—å /en/ –ø—Ä–µ—Ñ–∏–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞
        $clean_path = str_replace('/en/', '/', $request_uri);
        
        // –ù–∞–π—Ç–∏ –ø–æ—Å—Ç –ø–æ –ø—É—Ç–∏ –Ω–∞ –¥—Ä—É–≥–æ–º —è–∑—ã–∫–µ
        $default_lang = pll_default_language();
        $post_id = url_to_postid($clean_path);
        
        if (!$post_id) {
            return;
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ç–µ–∫—É—â–∏–π —è–∑—ã–∫
        $translation_id = pll_get_post($post_id, $current_lang);
        
        if ($translation_id && $translation_id != $post_id) {
            $redirect_url = get_permalink($translation_id);
            wp_redirect($redirect_url, 301);
            exit;
        }
    }
}

new Maslovka_Polylang_Redirects();
```

---

### –ü–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

**–§–∞–π–ª:** `wp-content/plugins/maslovka-polylang-duplicator/maslovka-polylang-duplicator.php`

```php
<?php
/**
 * Plugin Name: Maslovka Polylang Duplicator
 * Description: –ê–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–∞
 * Version: 1.0
 * Author: Maslovka Team
 */

if (!defined('ABSPATH')) exit;

class Maslovka_Polylang_Duplicator {
    
    public function __construct() {
        add_action('save_post', array($this, 'duplicate_content'), 10, 2);
    }
    
    public function duplicate_content($post_id, $post) {
        // –ü—Ä–æ–≤–µ—Ä–∫–∏
        if (wp_is_post_revision($post_id) || wp_is_post_autosave($post_id)) {
            return;
        }
        
        if (!function_exists('pll_get_post')) {
            return;
        }
        
        // –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤
        if ($post->post_content || $post->post_status !== 'auto-draft') {
            return;
        }
        
        // –ù–∞–π—Ç–∏ –∏—Å—Ö–æ–¥–Ω—ã–π –ø–æ—Å—Ç
        $translations = pll_get_post_translations($post_id);
        $source_post_id = null;
        
        foreach ($translations as $lang => $trans_id) {
            if ($trans_id != $post_id) {
                $source_post_id = $trans_id;
                break;
            }
        }
        
        if (!$source_post_id) {
            return;
        }
        
        $source_post = get_post($source_post_id);
        
        // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç
        wp_update_post(array(
            'ID' => $post_id,
            'post_content' => $source_post->post_content,
            'post_excerpt' => $source_post->post_excerpt,
        ));
        
        // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å featured image
        $thumbnail_id = get_post_thumbnail_id($source_post_id);
        if ($thumbnail_id) {
            set_post_thumbnail($post_id, $thumbnail_id);
        }
        
        // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ACF –ø–æ–ª—è
        if (function_exists('get_fields')) {
            $fields = get_fields($source_post_id);
            if ($fields) {
                foreach ($fields as $key => $value) {
                    update_field($key, $value, $post_id);
                }
            }
        }
        
        // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Ä–º–∏–Ω—ã
        $taxonomies = get_object_taxonomies($source_post->post_type);
        foreach ($taxonomies as $taxonomy) {
            $terms = wp_get_post_terms($source_post_id, $taxonomy, array('fields' => 'ids'));
            if ($terms && !is_wp_error($terms)) {
                wp_set_post_terms($post_id, $terms, $taxonomy);
            }
        }
    }
}

new Maslovka_Polylang_Duplicator();
```

---

## ‚è± –í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏

| –§–∞–∑–∞ | –ó–∞–¥–∞—á–∞ | –í—Ä–µ–º—è |
|------|--------|-------|
| 1 | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Polylang | 2-3 —á–∞—Å–∞ |
| 2 | –°–æ–∑–¥–∞–Ω–∏–µ SQL –º–∏–≥—Ä–∞—Ü–∏–π | 1-2 —á–∞—Å–∞ |
| 3 | –ü–µ—Ä–µ–≤–æ–¥—ã —Ç–µ–º—ã (pll__, strings) | 3-4 —á–∞—Å–∞ |
| 4 | –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤ | 1-2 —á–∞—Å–∞ |
| 5 | –î–µ–º–æ-–∫–æ–Ω—Ç–µ–Ω—Ç –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 1 —á–∞—Å |
| 6 | SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–Ω–∞ LOCAL) | 1-2 —á–∞—Å–∞ |
| 7 | –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ DEV | 30 –º–∏–Ω—É—Ç |
| 8 | –î–µ–ø–ª–æ–π –Ω–∞ PROD | 1 —á–∞—Å |
| 9 | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ | 1 —á–∞—Å |
| **–ò—Ç–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** | | **12-17 —á–∞—Å–æ–≤** |
| **–ú–∞—Å—Å–æ–≤—ã–π –ø–µ—Ä–µ–≤–æ–¥** | –°–æ—Ç–Ω–∏ –ø–æ—Å—Ç–æ–≤, –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∏ | **2-3 –º–µ—Å—è—Ü–∞** |

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã

### –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ CPT

```sql
-- –û–±–Ω–æ–≤–∏—Ç—å polylang –≤ wp_options
-- –£–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –º–∞—Å—Å–∏–≤–∞ post_types
-- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π CPT –≤ —Å–ø–∏—Å–æ–∫
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–π

**SQL (phpMyAdmin –∏–ª–∏ MySQL CLI):**
```sql
-- –Ø–∑—ã–∫–∏ —Å–æ–∑–¥–∞–Ω—ã?
SELECT t.name, t.slug FROM wp_terms t 
JOIN wp_term_taxonomy tt ON t.term_id = tt.term_id 
WHERE tt.taxonomy = 'language';

-- CPT –≤–∫–ª—é—á–µ–Ω—ã?
SELECT option_value FROM wp_options WHERE option_name = 'polylang';
-- –ò—Å–∫–∞—Ç—å: post_types –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ

-- –ú–µ–Ω—é –Ω–∞ –º–µ—Å—Ç–µ?
SELECT t.name FROM wp_terms t 
JOIN wp_term_taxonomy tt ON t.term_id = tt.term_id 
WHERE tt.taxonomy = 'nav_menu';

-- –°—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã?
SELECT option_name FROM wp_options WHERE option_name LIKE 'polylang_mo%';
```

**WP-CLI (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω):**
```bash
wp option get polylang --format=yaml
```

### Flush permalinks

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:
```
WordPress Admin ‚Üí Settings ‚Üí Permalinks ‚Üí Save Changes
```

---

## üìã Workflow –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤

**–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞:**
1. –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Å—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º
2. Languages ‚Üí + English
3. –ö–æ–Ω—Ç–µ–Ω—Ç —Å–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç, –∑–∞–≥–æ–ª–æ–≤–æ–∫, excerpt
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ACF –ø–æ–ª—è
6. Publish

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å:**
- [ ] –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω
- [ ] –ö–æ–Ω—Ç–µ–Ω—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω
- [ ] Excerpt –ø–µ—Ä–µ–≤–µ–¥–µ–Ω
- [ ] Featured image –Ω–∞ –º–µ—Å—Ç–µ
- [ ] ACF –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [ ] –ö–∞—Ç–µ–≥–æ—Ä–∏–∏/—Ç–µ–≥–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã
- [ ] –ü—Ä–µ–≤—å—é –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–∞:**
1. –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ + –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
2. –¢–æ–ø-10 –∫–æ–ª–ª–µ–∫—Ü–∏–π
3. –¢–µ–∫—É—â–∏–µ –≤—ã—Å—Ç–∞–≤–∫–∏
4. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Polylang

### –£—Ä–æ–≤–Ω–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
1. Unit —Ç–µ—Å—Ç—ã (PHP/JS) - –≤ —Ç–µ–º–µ
   ‚îî‚îÄ tests/unit/

2. E2E —Ç–µ—Å—Ç—ã (Playwright) - –≤ —Ç–µ–º–µ
   ‚îî‚îÄ tests/e2e/

3. Smoke —Ç–µ—Å—Ç—ã (Bash) - –≤ deployment-scripts
   ‚îî‚îÄ smoke-tests.sh

4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ - –≤—Ä—É—á–Ω—É—é
```

---

### 1. Unit —Ç–µ—Å—Ç—ã —Ç–µ–º—ã (PHP + Jest)

**–°–æ–∑–¥–∞—Ç—å:** `tests/unit/php/PolylangTest.php`

```php
<?php
/**
 * Tests for Polylang integration
 */

use PHPUnit\Framework\TestCase;
use Brain\Monkey;
use Brain\Monkey\Functions;

class PolylangTest extends TestCase {
    
    protected function setUp(): void {
        parent::setUp();
        Monkey\setUp();
    }
    
    protected function tearDown(): void {
        Monkey\tearDown();
        parent::tearDown();
    }
    
    /**
     * Test: pll_current_language() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —è–∑—ã–∫
     */
    public function test_pll_current_language_returns_ru_by_default() {
        Functions\when('pll_current_language')->justReturn('ru');
        
        $lang = pll_current_language();
        
        $this->assertEquals('ru', $lang);
    }
    
    /**
     * Test: pll__() –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å—Ç—Ä–æ–∫—É
     */
    public function test_pll_translates_string() {
        Functions\when('pll__')->alias(function($string) {
            $translations = [
                '–ü–æ–¥—Ä–æ–±–Ω–µ–µ' => 'Read more',
                '–ù–∞–∑–∞–¥' => 'Back',
            ];
            return $translations[$string] ?? $string;
        });
        
        $translated = pll__('–ü–æ–¥—Ä–æ–±–Ω–µ–µ');
        
        $this->assertEquals('Read more', $translated);
    }
    
    /**
     * Test: —è–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω
     */
    public function test_language_switcher_respects_acf_setting() {
        // –í–∫–ª—é—á–µ–Ω
        Functions\when('get_field')->justReturn(true);
        Functions\when('pll_the_languages')->justReturn('<a href="/en/">EN</a>');
        
        ob_start();
        if (get_field('show_language_switcher')) {
            echo pll_the_languages();
        }
        $output = ob_get_clean();
        
        $this->assertStringContainsString('EN', $output);
        
        // –í—ã–∫–ª—é—á–µ–Ω
        Functions\when('get_field')->justReturn(false);
        
        ob_start();
        if (get_field('show_language_switcher')) {
            echo pll_the_languages();
        }
        $output = ob_get_clean();
        
        $this->assertEmpty($output);
    }
    
    /**
     * Test: hreflang —Ç–µ–≥–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
     */
    public function test_hreflang_tags_generation() {
        Functions\when('pll_the_languages')->justReturn([
            ['slug' => 'ru', 'url' => 'https://site.com/'],
            ['slug' => 'en', 'url' => 'https://site.com/en/'],
        ]);
        
        $languages = pll_the_languages(['raw' => 1]);
        
        $this->assertCount(2, $languages);
        $this->assertEquals('ru', $languages[0]['slug']);
        $this->assertEquals('en', $languages[1]['slug']);
    }
}
```

**–ó–∞–ø—É—Å–∫:**
```bash
docker compose exec php bash -c "cd /var/www/html/wp-content/themes/maslovka && composer test"
```

---

### 2. E2E —Ç–µ—Å—Ç—ã (Playwright)

**–°–æ–∑–¥–∞—Ç—å:** `tests/e2e/specs/polylang.spec.js`

```javascript
import { test, expect } from '@playwright/test';

test.describe('Polylang - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤', () => {
  
  test('–≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ –æ–±–æ–∏—Ö —è–∑—ã–∫–∞—Ö', async ({ page }) => {
    // –†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è
    await page.goto('/');
    await expect(page).toHaveTitle(/Maslovka/i);
    
    // –ê–Ω–≥–ª–∏–π—Å–∫–∞—è –≤–µ—Ä—Å–∏—è
    await page.goto('/en/');
    await expect(page).toHaveTitle(/Maslovka/i);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    const ruLang = await page.getAttribute('html', 'lang');
    await page.goto('/en/');
    const enLang = await page.getAttribute('html', 'lang');
    
    expect(ruLang).toContain('ru');
    expect(enLang).toContain('en');
  });
  
  test('—è–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç', async ({ page }) => {
    await page.goto('/');
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω –≤ ACF)
    const switcher = page.locator('.language-switcher');
    const isVisible = await switcher.isVisible().catch(() => false);
    
    if (isVisible) {
      // –ö–ª–∏–∫ –ø–æ –∞–Ω–≥–ª–∏–π—Å–∫–æ–π –≤–µ—Ä—Å–∏–∏
      const enLink = switcher.locator('a[href*="/en/"]');
      await enLink.click();
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫—É—é –≤–µ—Ä—Å–∏—é
      await expect(page).toHaveURL(/\/en\//);
    }
  });
  
  test('hreflang —Ç–µ–≥–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç', async ({ page }) => {
    await page.goto('/');
    
    const hreflangs = await page.locator('link[rel="alternate"][hreflang]').count();
    
    // –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 2 —Ç–µ–≥–∞ (ru, en) + x-default
    expect(hreflangs).toBeGreaterThanOrEqual(2);
  });
  
  test('canonical —Ç–µ–≥ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω', async ({ page }) => {
    await page.goto('/');
    
    const canonical = page.locator('link[rel="canonical"]');
    await expect(canonical).toHaveAttribute('href', /https:\/\//);
  });
  
  test('–ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–º–µ–µ—Ç —Ç–æ—Ç –∂–µ –∫–æ–Ω—Ç–µ–Ω—Ç', async ({ page }) => {
    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ—Å—Ç —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º
    await page.goto('/test-post/');
    const ruTitle = await page.locator('h1').textContent();
    
    await page.goto('/en/test-post-2/'); // –° —Å—É—Ñ—Ñ–∏–∫—Å–æ–º –æ—Ç Polylang
    const enTitle = await page.locator('h1').textContent();
    
    // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–æ–ª–∂–Ω—ã –æ—Ç–ª–∏—á–∞—Ç—å—Å—è (–ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã)
    expect(ruTitle).not.toBe(enTitle);
  });
  
  test('—Ä–µ–¥–∏—Ä–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö slug', async ({ page }) => {
    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ /en/slug/ (–∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
    // –î–æ–ª–∂–µ–Ω —Å—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /en/slug-2/
    const response = await page.goto('/en/test-slug/', { waitUntil: 'networkidle' });
    
    // –ï—Å–ª–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å—Ä–∞–±–æ—Ç–∞–ª
    if (response.status() === 200) {
      expect(page.url()).toContain('/en/test-slug');
    }
  });
});

test.describe('Polylang - SEO', () => {
  
  test('Open Graph locale –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω', async ({ page }) => {
    await page.goto('/');
    
    const ogLocale = page.locator('meta[property="og:locale"]');
    await expect(ogLocale).toHaveAttribute('content', /ru/);
    
    await page.goto('/en/');
    const ogLocaleEn = page.locator('meta[property="og:locale"]');
    await expect(ogLocaleEn).toHaveAttribute('content', /en/);
  });
  
  test('og:locale:alternate –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç', async ({ page }) => {
    await page.goto('/');
    
    const ogAlternate = await page.locator('meta[property="og:locale:alternate"]').count();
    expect(ogAlternate).toBeGreaterThanOrEqual(1);
  });
});

test.describe('Polylang - –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –ø–ª–∞–≥–∏–Ω–∞–º–∏', () => {
  
  test('–Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å maslovka-redirects', async ({ page }) => {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –æ–±–∞ –ø–ª–∞–≥–∏–Ω–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
    await page.goto('/');
    
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –∏–∑ –æ–±–æ–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç
    const response = await page.goto('/old-url/', { waitUntil: 'networkidle' });
    
    // –û–¥–∏–Ω –∏–∑ –ø–ª–∞–≥–∏–Ω–æ–≤ –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç
    expect([200, 301, 302]).toContain(response.status());
  });
  
  test('—Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–º–µ—Å—Ç–µ —Å Polylang', async ({ page }) => {
    // –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Å—Ç–∞ "–¢–µ—Å—Ç" slug –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å test
    // –ü—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–µ –Ω–∞ EN slug –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å test-2
    
    // –≠—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä, –∑–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏–º —á—Ç–æ URL –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
    await page.goto('/test/');
    expect(page.url()).not.toContain('%');
    
    await page.goto('/en/test-2/');
    expect(page.url()).not.toContain('%');
  });
});
```

**–ó–∞–ø—É—Å–∫:**
```bash
# –í —Ç–µ–º–µ
cd www/wordpress/wp-content/themes/maslovka/tests/e2e
npm install
npx playwright test

# –ò–ª–∏ —Å —Ö–æ—Å—Ç–∞ —á–µ—Ä–µ–∑ Docker
docker compose exec php bash -c "cd /var/www/html/wp-content/themes/maslovka/tests/e2e && npx playwright test"
```

---

### 3. Smoke —Ç–µ—Å—Ç—ã (deployment-scripts)

**–û–±–Ω–æ–≤–∏—Ç—å:** `www/deployment-scripts/smoke-tests.sh`

–î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö 8 —Ç–µ—Å—Ç–æ–≤:

```bash
# Test 9: Polylang - –æ–±–∞ —è–∑—ã–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã
test_polylang_languages() {
    echo -e "${BLUE}[9/12]${NC} Testing Polylang languages..."
    HTTP_CODE_RU=$(curl_with_auth -s -o /dev/null -w "%{http_code}" "${SITE_URL}/")
    HTTP_CODE_EN=$(curl_with_auth -s -o /dev/null -w "%{http_code}" "${SITE_URL}/en/")
    
    if [ "$HTTP_CODE_RU" == "200" ] && [ "$HTTP_CODE_EN" == "200" ]; then
        echo -e "${GREEN}‚úì${NC} Both languages accessible"; PASSED_TESTS=$((PASSED_TESTS + 1))
    else
        echo -e "${RED}‚úó${NC} RU: $HTTP_CODE_RU, EN: $HTTP_CODE_EN"; FAILED_TESTS=$((FAILED_TESTS + 1))
    fi
}

# Test 10: Polylang - hreflang —Ç–µ–≥–∏
test_hreflang_tags() {
    echo -e "${BLUE}[10/12]${NC} Testing hreflang tags..."
    HREFLANG_COUNT=$(curl_with_auth -s "${SITE_URL}/" | grep -c 'hreflang=' || echo "0")
    
    if [ "$HREFLANG_COUNT" -ge 2 ]; then
        echo -e "${GREEN}‚úì${NC} Hreflang tags found ($HREFLANG_COUNT)"; PASSED_TESTS=$((PASSED_TESTS + 1))
    else
        echo -e "${RED}‚úó${NC} Missing hreflang tags"; FAILED_TESTS=$((FAILED_TESTS + 1))
    fi
}

# Test 11: Polylang –ø–ª–∞–≥–∏–Ω—ã –∞–∫—Ç–∏–≤–Ω—ã (curl –ø—Ä–æ–≤–µ—Ä–∫–∞)
test_polylang_plugins() {
    echo -e "${BLUE}[11/12]${NC} Testing Polylang plugins..."
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    LANG_SWITCHER=$(curl_with_auth -s "${SITE_URL}/" | grep -c 'language-switcher\|pll-' || echo "0")
    
    if [ "$LANG_SWITCHER" -ge 1 ]; then
        echo -e "${GREEN}‚úì${NC} Polylang active (switcher found)"; PASSED_TESTS=$((PASSED_TESTS + 1))
    else
        echo -e "${YELLOW}‚ö†Ô∏è  No language switcher (may be disabled by ACF)${NC}"; PASSED_TESTS=$((PASSED_TESTS + 1))
    fi
}

# Test 12: –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å - —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
test_plugin_compatibility() {
    echo -e "${BLUE}[12/12]${NC} Testing plugin compatibility..."
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ URL —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    HTTP_CODE=$(curl_with_auth -s -o /dev/null -w "%{http_code}" "${SITE_URL}/test-post/")
    
    if [ "$HTTP_CODE" == "200" ] || [ "$HTTP_CODE" == "301" ] || [ "$HTTP_CODE" == "302" ]; then
        echo -e "${GREEN}‚úì${NC} URL handling works ($HTTP_CODE)"; PASSED_TESTS=$((PASSED_TESTS + 1))
    else
        echo -e "${YELLOW}‚ö†Ô∏è  Check redirects manually${NC}"; PASSED_TESTS=$((PASSED_TESTS + 1))
    fi
}
```

---

### 4. –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß–µ–∫-–ª–∏—Å—Ç –ø–æ —Ñ–∞–∑–∞–º:**

```bash
# –§–∞–∑–∞ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —è–∑—ã–∫–∏ (SQL)
# SELECT t.name, t.slug FROM wp_terms t JOIN wp_term_taxonomy tt ON t.term_id = tt.term_id WHERE tt.taxonomy = 'language';

# –§–∞–∑–∞ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ–Ω—é (–≤–∏–∑—É–∞–ª—å–Ω–æ –≤ Appearance ‚Üí Menus)

# –§–∞–∑–∞ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã —Ç–µ–º—ã
curl -s https://localhost/ | grep -o '–ü–æ–¥—Ä–æ–±–Ω–µ–µ'
curl -s https://localhost/en/ | grep -o 'Read more'

# –§–∞–∑–∞ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–ª–∞–≥–∏–Ω—ã
# –í–∏–∑—É–∞–ª—å–Ω–æ –≤ Plugins ‚Üí –∞–∫—Ç–∏–≤–Ω—ã maslovka-polylang-*
# –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç "test" –Ω–∞ RU ‚Üí –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ EN ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç:
curl -I https://localhost/en/test/  # –û–∂–∏–¥–∞–µ–º–æ: 301 ‚Üí /en/test-2/

# –§–∞–∑–∞ 6: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SEO
curl -s https://localhost/ | grep hreflang  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 2+ —Ç–µ–≥–æ–≤
curl -s https://localhost/ | grep canonical
curl -s https://localhost/ | grep og:locale

# –§–∞–∑—ã 7-8: Smoke —Ç–µ—Å—Ç—ã
cd www/deployment-scripts
./smoke-tests.sh dev  # –∏–ª–∏ prod
```

**–§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç:**

- [ ] Unit —Ç–µ—Å—Ç—ã (PHP/JS) –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] E2E —Ç–µ—Å—Ç—ã (Playwright) –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] Smoke —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –Ø–∑—ã–∫–∏ RU/EN –¥–æ—Å—Ç—É–ø–Ω—ã
- [ ] –ü–µ—Ä–µ–≤–æ–¥—ã —Å—Ç—Ä–æ–∫ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω –≤ ACF)
- [ ] –†–µ–¥–∏—Ä–µ–∫—Ç—ã –Ω–∞ /en/slug-2/ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] ACF/Featured images –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–µ
- [ ] Hreflang/canonical —Ç–µ–≥–∏ –Ω–∞ –º–µ—Å—Ç–µ
- [ ] –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å maslovka-redirects
- [ ] –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å maslovka-transliterator
- [ ] –ù–µ—Ç 404 –æ—à–∏–±–æ–∫
- [ ] –ù–µ—Ç PHP errors –≤ –ª–æ–≥–∞—Ö

---

## üéâ –†–µ–∑—é–º–µ

### –ß—Ç–æ –ø–æ–ª—É—á–∞–µ–º:

‚úÖ **Polylang FREE** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö  
‚úÖ **SQL –º–∏–≥—Ä–∞—Ü–∏–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–Ω–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫  
‚úÖ **–ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã** - —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã + –∞–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ  
‚úÖ **–ü–µ—Ä–µ–≤–æ–¥—ã —Ç–µ–º—ã** - –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —á–µ—Ä–µ–∑ `pll__()`  
‚úÖ **SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - hreflang, canonical, sitemap  
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤  

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å –§–∞–∑—É 1 –Ω–∞ LOCAL (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Polylang)
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å SQL –º–∏–≥—Ä–∞—Ü–∏–∏ (–§–∞–∑–∞ 2)
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–º—É —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ (–§–∞–∑–∞ 3)
4. ‚úÖ –°–æ–∑–¥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã (–§–∞–∑–∞ 4)
5. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –¥–µ–º–æ-–∫–æ–Ω—Ç–µ–Ω—Ç–µ (–§–∞–∑–∞ 5)
6. ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ DEV ‚Üí PROD (–§–∞–∑—ã 6-7)
7. ‚úÖ –ù–∞—á–∞—Ç—å –º–∞—Å—Å–æ–≤—ã–π –ø–µ—Ä–µ–≤–æ–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏!** üöÄ
