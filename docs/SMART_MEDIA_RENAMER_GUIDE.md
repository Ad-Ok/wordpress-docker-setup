# –£–º–Ω—ã–π –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç–µ–ª—å –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ WordPress

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã, –∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≤–µ—Å—å –∫–æ–Ω—Ç–µ–∫—Å—Ç** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω. –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥—É–ª–∏ –¥–ª—è –ª—É—á—à–µ–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
media-renamer/
‚îú‚îÄ‚îÄ config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ logging_utils.php      # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ file_utils.php         # –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ rename_logic_utils.php # –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ analytics_utils.php    # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îú‚îÄ‚îÄ output/           # JSON —Ñ–∞–π–ª—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º
‚îÇ   ‚îú‚îÄ‚îÄ current-processing.json  # –¢–µ–∫—É—â–∏–µ —Ñ–∞–π–ª—ã –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ
‚îÇ   ‚îú‚îÄ‚îÄ approved-rules.json      # –û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
‚îÇ   ‚îî‚îÄ‚îÄ denied-rules.json        # –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
‚îú‚îÄ‚îÄ logs/             # –õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ reports/          # –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã
‚îî‚îÄ‚îÄ scripts/          # –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
```

### –ß—Ç–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è:

1. **Caption (–ø–æ–¥–ø–∏—Å—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)** - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Ññ1
2. **Alt-—Ç–µ–∫—Å—Ç** - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Ññ2
3. **–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞**
4. **Slug —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞**
5. **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞**
6. **–¢–µ–≥–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞**
7. **–û–ø–∏—Å–∞–Ω–∏–µ attachment**
8. **–ì–æ–¥ –∏–∑ —Ç–µ–∫—Å—Ç–∞** (–∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ caption/–æ–ø–∏—Å–∞–Ω–∏—è)

### –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

**–î–æ:**
```
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ-WhatsApp-2025-10-03-–≤-16.47.43_c6f98c67.jpg
```

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**
- Caption: "–ú–∞—Ä–∏—è –ê—Ä–µ–Ω–¥—Ç. –ò–Ω–¥–∏—è 2007."
- –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø–æ—Å—Ç: "arendt-mariya"
- –ö–∞—Ç–µ–≥–æ—Ä–∏—è: "–§–æ—Ç–æ"

**–ü–æ—Å–ª–µ:**
```
photo-mariya-arendt-india-2007.jpg
```

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–°–∏—Å—Ç–µ–º–∞ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ WordPress. –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `wp-content/media-renamer/`.

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—É—Å–∫

```bash
# –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞)
docker exec -it wordpress_php php /var/www/html/wp-content/media-renamer/scripts/run-smart-renamer.php dry-run 10

# –ë–æ–µ–≤–æ–π —Ä–µ–∂–∏–º (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º)
docker exec -it wordpress_php php /var/www/html/wp-content/media-renamer/scripts/run-smart-renamer.php run 100
```

### JSON —Ñ–∞–π–ª—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º

–°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç—Ä–∏ JSON —Ñ–∞–π–ª–∞ –≤ `output/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:

1. **`current-processing.json`** - –¢–µ–∫—É—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ
   - –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã –∏ –æ–∂–∏–¥–∞—é—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

2. **`approved-rules.json`** - –û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
   - –§–∞–π–ª—ã, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ
   - –ò—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

3. **`denied-rules.json`** - –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
   - –§–∞–π–ª—ã, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ —É–¥–∞–ª–æ—Å—å –∏–ª–∏ –±—ã–ª–æ –æ—Ç–º–µ–Ω–µ–Ω–æ
   - –¢–∞–∫–∂–µ –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –∏–∑ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ PHP –Ω–∞–ø—Ä—è–º—É—é (–ë–ï–ó WP-CLI)

–≠—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - WP-CLI –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!

**–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –Ω–∞ 5 —Ñ–∞–π–ª–∞—Ö:**
```bash
docker exec -it wordpress_php php /var/www/html/run-smart-renamer.php dry-run 5
```

**–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –Ω–∞ 50 —Ñ–∞–π–ª–∞—Ö:**
```bash
docker exec -it wordpress_php php /var/www/html/run-smart-renamer.php dry-run 50
```

**–ë–æ–µ–≤–æ–π –∑–∞–ø—É—Å–∫ –Ω–∞ 100 —Ñ–∞–π–ª–∞—Ö:**
```bash
docker exec -it wordpress_php php /var/www/html/run-smart-renamer.php run 100
```

**–í—Å–µ —Ñ–∞–π–ª—ã:**
```bash
docker exec -it wordpress_php php /var/www/html/run-smart-renamer.php run
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ WP-CLI (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

**–ù–∞ 10 —Ñ–∞–π–ª–∞—Ö:**
```bash
docker exec -it wordpress_php wp eval-file smart-media-renamer.php -- --dry-run --limit=10
```

**–ù–∞ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π):**
```bash
docker exec -it wordpress_php wp eval-file smart-media-renamer.php -- --dry-run
```

### 2. –ë–æ–µ–≤–æ–π –∑–∞–ø—É—Å–∫

**–í–ê–ñ–ù–û:** –ü–µ—Ä–µ–¥ –±–æ–µ–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø!

**–ù–µ–±–æ–ª—å—à–∞—è –ø–∞—Ä—Ç–∏—è (100 —Ñ–∞–π–ª–æ–≤):**
```bash
docker exec -it wordpress_php wp eval-file smart-media-renamer.php -- --limit=100
```

**–í—Å–µ —Ñ–∞–π–ª—ã:**
```bash
docker exec -it wordpress_php wp eval-file smart-media-renamer.php
```

---

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|----------|--------|
| `--dry-run` | –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π | `--dry-run` |
| `--limit=N` | –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ N —Ñ–∞–π–ª–æ–≤ | `--limit=100` |

---

## –õ–æ–≥–∏–∫–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–º–µ–Ω–∏:

1. **Caption** - –µ—Å–ª–∏ –¥–ª–∏–Ω–∞ >= 10 —Å–∏–º–≤–æ–ª–æ–≤
2. **Alt-—Ç–µ–∫—Å—Ç** - –µ—Å–ª–∏ caption –ø—É—Å—Ç–æ–π
3. **Parent slug** - –µ—Å–ª–∏ –Ω–µ—Ç caption –∏ alt
4. **Attachment title** - –µ—Å–ª–∏ –Ω–µ "–º—É—Å–æ—Ä–Ω–æ–µ" –∏–º—è
5. **Parent title** - –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç
6. **Fallback** - `media-{ID}-{year}`

### –ü—Ä–µ—Ñ–∏–∫—Å—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π:

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è (RU) | –ü—Ä–µ—Ñ–∏–∫—Å |
|----------------|---------|
| –§–æ—Ç–æ, –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è | `photo-` |
| –ö–∞—Ä—Ç–∏–Ω–∞, –ñ–∏–≤–æ–ø–∏—Å—å | `artwork-` |
| –ü–æ—Ä—Ç—Ä–µ—Ç | `portrait-` |
| –ü–µ–π–∑–∞–∂ | `landscape-` |
| –°–æ–±—ã—Ç–∏–µ, –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ | `event-` |
| –í—ã—Å—Ç–∞–≤–∫–∞ | `exhibition-` |
| –ö–æ–ª–ª–µ–∫—Ü–∏—è | `collection-` |
| –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ | `modern-` |

### –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞:

1. **–¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã:**
   - `–ú–∞—Ä–∏—è` ‚Üí `mariya`
   - `–ü–æ—Ä—Ç—Ä–µ—Ç` ‚Üí `portret`

2. **–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–æ–ø-—Å–ª–æ–≤:**
   - `–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ`, `—Ñ–æ—Ç–æ`, `whatsapp`, `copy`, `of`
   - –ø—Ä–µ–¥–ª–æ–≥–∏: `–≤`, `–Ω–∞`, `—Å`, `–¥–ª—è`, `–æ—Ç`

3. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥–æ–¥–∞:**
   - `1975 –≥.` ‚Üí `1975`
   - `2007.` ‚Üí `2007`

4. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:**
   - –í—Å–µ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
   - –¢–æ–ª—å–∫–æ `a-z`, `0-9`, –¥–µ—Ñ–∏—Å
   - –ú–∞–∫—Å–∏–º—É–º 60 —Å–∏–º–≤–æ–ª–æ–≤

### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ):

| –ë—ã–ª–æ | –ö–æ–Ω—Ç–µ–∫—Å—Ç | –°—Ç–∞–Ω–µ—Ç |
|------|----------|--------|
| `photo_2025-07-26_18-00-19.jpg` | Caption: "–£—Ç—Ä–µ–Ω–Ω–µ–µ –º–æ–ª–æ–∫–æ, 1960" | `utrennee-moloko-1960.jpg` |
| `9256c79f3066ca1c83035bbdb062b9c71f172a05.png` | Caption: "–Æ—Ä–∏–π –ü–∏–º–µ–Ω–æ–≤", Parent: "–ö–∏–±—Ä–∏–∫" | `yuriy-pimenov.png` |
| `902d5568fcb530814ddc79f68af48abb69cde855.png` | Caption: "–§—Ä–æ–Ω—Ç–æ–≤–∞—è –¥–æ—Ä–æ–≥–∞, 1944" | `frontovaya-doroga-1944.png` |
| `a5b4e5c21b098f7ad8a1b4614c31c43b404e7383.png` | Caption: "–ù–æ–≤–∞—è –ú–æ—Å–∫–≤–∞, 1937" | `novaya-moskva-1937.png` |
| `photo_2025-07-26_17-28-13.jpg` | Caption: "–ø—Ä–æ–≤–µ—Ä–∫–∞", Parent: "–ú–∞—Å–ª–æ–≤–∫–∞" | `maslovka-gorodok-hudozhnikov.jpg` |
| `464343261_8940343842662436_n.jpg` | Parent slug: "berlin-1929" | `berlin-1929.jpg` |
| `–º–∞–∫–µ—Ç-–¥–ª—è-—Å–æ–±—ã—Ç–∏–π.png` | Parent: "vystavka-arendt", Category: "–í—ã—Å—Ç–∞–≤–∫–∞" | `exhibition-vystavka-arendt.png` |

---

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:

### 1. –ê–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞:

‚úì –°–æ–±–∏—Ä–∞–µ—Ç –≤–µ—Å—å –∫–æ–Ω—Ç–µ–∫—Å—Ç (caption, alt, parent, categories)  
‚úì –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏–º—è  
‚úì –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å  
‚úì –õ–æ–≥–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è  

### 2. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ:

‚úì –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç **–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª**  
‚úì –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç **–≤—Å–µ –º–∏–Ω–∏–∞—Ç—é—Ä—ã** (150x150, 300x..., 768x..., 1024x..., 1536x...)  
‚úì –û–±–Ω–æ–≤–ª—è–µ—Ç `_wp_attached_file` –≤ postmeta  
‚úì –û–±–Ω–æ–≤–ª—è–µ—Ç `_wp_attachment_metadata` (—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)  
‚úì –û–±–Ω–æ–≤–ª—è–µ—Ç `guid` –≤ wp_posts  
‚úì –ó–∞–º–µ–Ω—è–µ—Ç —Å—Å—ã–ª–∫–∏ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤  

### 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

‚úì –ù–µ —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã  
‚úì –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –Ω–µ-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è  
‚úì –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ñ–∞–π–ª—ã —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏  
‚úì –î–æ–±–∞–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫ –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö –∏–º–µ–Ω  
‚úì –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ JSON  

---

## –í—ã–≤–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ (dry-run):

```
=== –£–º–Ω—ã–π –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç–µ–ª—å –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ ===
–†–µ–∂–∏–º: –¢–ï–°–¢–û–í–´–ô (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
–õ–∏–º–∏—Ç: 10 —Ñ–∞–π–ª–æ–≤

–ù–∞–π–¥–µ–Ω–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤: 10
--------------------------------------------------------------------------------
[3985] all_files-2f45_386f34677c8885ba16a43b10cf4cd22489398a32.jpg ‚Üí collection-hronos-1971.jpg
  Caption: –•—Ä–æ–Ω–æ—Å. 1971 –≥.
  Parent: mn0001

[3984] all_files-2f55_03ba4cb52cb78af6e78a3232431aa1ef02d0de80.jpg ‚Üí collection-tsezar-1971.jpg
  Caption: –¶–µ–∑–∞—Ä—å. 1971 –≥.
  Parent: mn0001

[3983] 141.jpg ‚Üí collection-koroleva-1969.jpg
  Caption: –ö–æ—Ä–æ–ª–µ–≤–∞. 1969 –≥.
  Parent: mn0001

...

================================================================================
–°–í–û–î–ö–ê:
  –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 10
  –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: 8
  –ü—Ä–æ–ø—É—â–µ–Ω–æ: 2
  –û—à–∏–±–æ–∫: 0
================================================================================

–õ–æ–≥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: /var/www/html/wp-content/smart-media-rename-log-2025-11-08-12-30-45.json
```

---

## –§–æ—Ä–º–∞—Ç –ª–æ–≥–∞

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π JSON-–ª–æ–≥ –≤ `wp-content/`:

```json
{
  "timestamp": "2025-11-08 12:30:45",
  "dry_run": true,
  "stats": {
    "processed": 10,
    "renamed": 8,
    "skipped": 2,
    "errors": 0
  },
  "settings": {
    "max_filename_length": 60,
    "prefer_caption": true,
    "use_parent_context": true
  },
  "log": [
    {
      "id": 3985,
      "old": "all_files-2f45_386f34677c8885ba16a43b10cf4cd22489398a32.jpg",
      "new": "collection-hronos-1971.jpg",
      "reason": "caption+parent+category:–ö–æ–ª–ª–µ–∫—Ü–∏—è",
      "timestamp": "2025-11-08 12:30:46"
    }
  ]
}
```

---

## –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)

```bash
# 1. –ü–æ–ª–Ω—ã–π –±—ç–∫–∞–ø –ë–î
cd /Users/adoknov/work/maslovka/www/deployment-scripts/database
./db-snapshot.sh "before-smart-rename"

# 2. –ë—ç–∫–∞–ø uploads
cd /Users/adoknov/work/maslovka/www
tar -czf uploads-backup-$(date +%Y%m%d-%H%M).tar.gz wordpress/wp-content/uploads/

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps | grep wordpress
```

### –≠—Ç–∞–ø 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –¢–µ—Å—Ç –Ω–∞ 5 —Ñ–∞–π–ª–∞—Ö (–±—ã—Å—Ç—Ä–æ!)
docker exec -it wordpress_php php /var/www/html/run-smart-renamer.php dry-run 5

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–≤–æ–¥ - –Ω—Ä–∞–≤—è—Ç—Å—è –ª–∏ –Ω–æ–≤—ã–µ –∏–º–µ–Ω–∞?

# 3. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥
docker exec -it wordpress_php cat wp-content/smart-media-rename-log-*.json | head -100

# 4. –ï—Å–ª–∏ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç - —Ç–µ—Å—Ç –Ω–∞ 50 —Ñ–∞–π–ª–∞—Ö
docker exec -it wordpress_php php /var/www/html/run-smart-renamer.php dry-run 50
```

### –≠—Ç–∞–ø 3: –ë–æ–µ–≤–æ–π –∑–∞–ø—É—Å–∫ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)

```bash
# 1. –ü–µ—Ä–≤–∞—è –ø–∞—Ä—Ç–∏—è - 100 —Ñ–∞–π–ª–æ–≤
docker exec -it wordpress_php php /var/www/html/run-smart-renamer.php run 100

# 2. –ü–†–û–í–ï–†–ö–ê –°–ê–ô–¢–ê:
# - –û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å—Ç–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
# - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
docker exec -it wordpress_php cat wp-content/smart-media-rename-log-*.json | grep error

# 4. –ï—Å–ª–∏ –≤—Å–µ –û–ö - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–∞—Ä—Ç–∏—è–º–∏ –ø–æ 500
docker exec -it wordpress_php php /var/www/html/run-smart-renamer.php run 500

# 5. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏–∏ - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–π—Ç–∞
```

### –≠—Ç–∞–ø 4: –ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ö–æ–≥–¥–∞ —É–±–µ–¥–∏–ª–∏—Å—å, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ
docker exec -it wordpress_php php /var/www/html/run-smart-renamer.php run

# –≠—Ç–æ –∑–∞–π–º–µ—Ç –≤—Ä–µ–º—è –¥–ª—è 2500+ —Ñ–∞–π–ª–æ–≤ (15-30 –º–∏–Ω—É—Ç)
```

### –≠—Ç–∞–ø 5: –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö
cat wp-content/smart-media-rename-log-*.json | grep "renamed"

# 2. –ù–∞–π—Ç–∏ –ø—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π
find wordpress/wp-content/uploads -name "photo-*" | head -20
find wordpress/wp-content/uploads -name "collection-*" | head -20

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∞–π—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
# - –ì–ª–∞–≤–Ω–∞—è
# - –°–ª—É—á–∞–π–Ω—ã–µ –ø–æ—Å—Ç—ã
# - –ú–µ–¥–∏–∞—Ç–µ–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ
```

---

## –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å —Å–≤–µ–∂–∏–π –±—ç–∫–∞–ø)

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker
cd /Users/adoknov/work/maslovka/www
docker-compose down

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å uploads
rm -rf wordpress/wp-content/uploads
tar -xzf uploads-backup-YYYYMMDD-HHMM.tar.gz

# 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î
cd deployment-scripts/database
./db-snapshot.sh --restore before-smart-rename

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker
cd /Users/adoknov/work/maslovka/www
docker-compose up -d
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–∫–∞—Ç –ø–æ –ª–æ–≥—É (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –∏–º–µ–Ω–∞ –∏–∑ –ª–æ–≥–∞)

–ú–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—á–∏—Ç–∞–µ—Ç –ª–æ–≥ –∏ –≤–µ—Ä–Ω–µ—Ç —Å—Ç–∞—Ä—ã–µ –∏–º–µ–Ω–∞.

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–¥–µ)

–í –Ω–∞—á–∞–ª–µ –∫–ª–∞—Å—Å–∞ `Smart_Media_Renamer`:

```php
private $settings = [
    'max_filename_length' => 60,       // –ú–∞–∫—Å. –¥–ª–∏–Ω–∞ –∏–º–µ–Ω–∏
    'min_filename_length' => 10,       // –ú–∏–Ω. –¥–ª–∏–Ω–∞ –¥–ª—è –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
    'prefer_caption' => true,          // Caption –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ
    'prefer_alt_text' => true,         // Alt –≤—Ç–æ—Ä–æ–π –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
    'use_parent_context' => true,      // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—è
    'use_categories' => true,          // –î–æ–±–∞–≤–ª—è—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π
    'transliterate' => true,           // –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è
    'add_counter' => true,             // –°—á–µ—Ç—á–∏–∫ –ø—Ä–∏ –¥—É–±–ª—è—Ö
    'preserve_year' => true,           // –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≥–æ–¥
];
```

---

## –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ß—Ç–æ –±—É–¥–µ—Ç —Å —Ñ–∞–π–ª–∞–º–∏ –±–µ–∑ caption –∏ alt?
**A:** –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback: parent slug ‚Üí attachment title ‚Üí parent title ‚Üí `media-{ID}`

### Q: –ò–∑–º–µ–Ω—è—é—Ç—Å—è –ª–∏ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π?
**A:** –î–∞, –Ω–æ —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ —Å—Å—ã–ª–∫–∏ –≤ –ë–î.

### Q: –ß—Ç–æ —Å SEO?
**A:** SEO —É–ª—É—á—à–∏—Ç—Å—è! –û—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –ª—É—á—à–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å —Ñ–∞–π–ª–æ–≤?
**A:** –î–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--limit=N` –∏–ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å –≤ –∫–æ–¥–µ.

### Q: –ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏ —ç—Ç–æ?
**A:** –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –±—ç–∫–∞–ø–∞ - –∞–±—Å–æ–ª—é—Ç–Ω–æ. –°–∫—Ä–∏–ø—Ç –Ω–µ —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã, —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç.

### Q: –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–π–º–µ—Ç –Ω–∞ 2500 —Ñ–∞–π–ª–æ–≤?
**A:** –ü—Ä–∏–º–µ—Ä–Ω–æ 15-30 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞).

### Q: –ù—É–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª—é—á–∞—Ç—å —Å–∞–π—Ç?
**A:** –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π:**
   ```php
   if (!preg_match('/[–ê-–Ø–∞-—è]/u', $old_file)) {
       $this->stats['skipped']++;
       return false;
   }
   ```

2. **–§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ –∑–∞–≥—Ä—É–∑–∫–∏:**
   ```php
   'date_query' => [
       'after' => '2025-01-01'
   ]
   ```

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AI (GPT) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–º–µ–Ω:**
   - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ Vision API
   - –ü–æ–ª—É—á–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏–º–µ–Ω–∏

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π:**
   ```php
   'tax_query' => [[
       'taxonomy' => 'category',
       'field' => 'slug',
       'terms' => 'fotografii'
   ]]
   ```

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥: `wp-content/smart-media-rename-log-*.json`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã: `ls -la wordpress/wp-content/uploads/`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PHP: `docker logs wordpress_php`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ WP-CLI —Ä–∞–±–æ—Ç–∞–µ—Ç: `docker exec -it wordpress_php wp --info`

---

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

- [ ] –°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π –±—ç–∫–∞–ø –ë–î
- [ ] –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø –ø–∞–ø–∫–∏ uploads
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω dry-run –Ω–∞ 10 —Ñ–∞–π–ª–∞—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω –≤—ã–≤–æ–¥ –∏ –ª–æ–≥
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω dry-run –Ω–∞ 100 —Ñ–∞–π–ª–∞—Ö
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—Å—Ç—Ä–∞–∏–≤–∞—é—Ç
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω –±–æ–µ–≤–æ–π –∑–∞–ø—É—Å–∫ –Ω–∞ 100 —Ñ–∞–π–ª–∞—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω —Å–∞–π—Ç (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –º–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- [ ] –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–π—Ç–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –º–µ–¥–∏–∞—Ç–µ–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ

–£–¥–∞—á–∏! üöÄ
