# üöÄ Deployment Cheatsheet

–ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –¥–µ–ø–ª–æ—é WordPress.

## üéØ –ö–∞–∫–æ–π —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –≠—Ç–æ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ?                             ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚úÖ –î–ê  ‚Üí  ./initial-deploy.sh [prod|dev]              ‚îÇ
‚îÇ  ‚ùå –ù–ï–¢ ‚Üí  ./deploy-prod.sh –∏–ª–∏ ./deploy-dev.sh        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü–µ—Ä–≤—ã–π —Ä–∞–∑ (Initial Setup)

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cd deployment-scripts
cp config.example.sh config.sh
nano config.sh

# 2. –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ DEV
./initial-deploy.sh dev

# 3. –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ PROD (–∫–æ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã)
./initial-deploy.sh prod
```

### –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞

```bash
# 1. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
git add .
git commit -m "feat: new feature"  # –∞–≤—Ç–æ–±–∏–ª–¥ CSS/JS
git push origin dev

# 2. –î–µ–ø–ª–æ–π –Ω–∞ DEV
./deploy-dev.sh

# 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞—Ç–µ–º –º–µ—Ä–∂ –≤ main
git checkout main
git merge dev
git push origin main

# 4. –î–µ–ø–ª–æ–π –Ω–∞ PROD
./deploy-prod.sh
```

### –î–µ–ø–ª–æ–π —Å —Ä—É—á–Ω—ã–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Polylang)

```bash
# 1. –î–µ–ø–ª–æ–π –ë–ï–ó –º–∏–≥—Ä–∞—Ü–∏–π (–¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
./deploy-dev.sh --skip-migrations
./deploy-prod.sh --skip-migrations  # –¢–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è PROD

# 2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ä—É—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
#    - –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –ø–ª–∞–≥–∏–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, Polylang)
#    - –°–æ–∑–¥–∞–π—Ç–µ —è–∑—ã–∫–∏, –º–µ–Ω—é –∏ —Ç.–¥.

# 3. –î–µ–ø–ª–æ–π –° –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ (–ø—Ä–∏–º–µ–Ω–∏—Ç –∑–∞–≤–∏—Å–∏–º—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏)
./deploy-dev.sh
./deploy-prod.sh
```

## üìÅ –ß—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

### Initial Deploy (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)

```
‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
  ‚Ä¢ –Ø–¥—Ä–æ WordPress (wp-admin, wp-includes)
  ‚Ä¢ wp-content –ø–æ–ª–Ω–æ—Å—Ç—å—é
  ‚Ä¢ wp-config.php, .htaccess
  ‚Ä¢ –í—Å–µ —Ç–µ–º—ã –∏ –ø–ª–∞–≥–∏–Ω—ã
  ‚Ä¢ Uploads (–∫–∞—Ä—Ç–∏–Ω–∫–∏)

‚ùå –ù–ï –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
  ‚Ä¢ node_modules/
  ‚Ä¢ .git/ (–ª–æ–∫–∞–ª—å–Ω—ã–π)
  ‚Ä¢ deployment-scripts/
  ‚Ä¢ docker-compose.yml
  ‚Ä¢ logs/, .env
```

### Regular Deploy (–æ–±—ã—á–Ω—ã–π)

```
‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:
  ‚Ä¢ –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (git pull)
  ‚Ä¢ –ë—ã—Å—Ç—Ä–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
```

## üîß –ö–æ–º–∞–Ω–¥—ã

### Initial Deployment

```bash
# PROD
./initial-deploy.sh prod

# DEV
./initial-deploy.sh dev
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–ª–Ω—ã–π WordPress —á–µ—Ä–µ–∑ rsync
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç Git –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- ~5-10 –º–∏–Ω—É—Ç

### Regular Deployment

```bash
# PROD (—Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏)
./deploy-prod.sh

# DEV (–±—ã—Å—Ç—Ä–æ)
./deploy-dev.sh

# Dry-run (—Ç–µ—Å—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
./deploy-prod.sh --dry-run

# –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–¥–ª—è DEV –∏ PROD)
./deploy-dev.sh --skip-migrations
./deploy-prod.sh --skip-migrations
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- Pre-deployment checklist
- –ë—ç–∫–∞–ø
- Git pull
- –ú–∏–≥—Ä–∞—Ü–∏–∏
- Smoke tests
- ~30 —Å–µ–∫—É–Ω–¥

### –û—Ç–∫–∞—Ç (Rollback)

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å –Ω–∞ 1 –∫–æ–º–º–∏—Ç –Ω–∞–∑–∞–¥
./rollback.sh prod

# –û—Ç–∫–∞—Ç–∏—Ç—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–º–º–∏—Ç
./rollback.sh prod abc123
```

### Hotfix (–°—Ä–æ—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

```bash
# –°–æ–∑–¥–∞—Ç—å hotfix –≤–µ—Ç–∫—É –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å
./hotfix.sh prod "fix-critical-bug"
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∏

### –î–æ –¥–µ–ø–ª–æ—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é
./pre-deployment-checklist.sh
```

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- ‚úì Git —Å—Ç–∞—Ç—É—Å (–Ω–µ—Ç –Ω–µ–∑–∞–∫–æ–º–∏—á–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- ‚úì –ù–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ
- ‚úì –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—É—à–µ–Ω—ã
- ‚úì –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úì –ë–∏–ª–¥ —É—Å–ø–µ—à–µ–Ω

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# Smoke tests –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é
./smoke-tests.sh prod
```

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- ‚úì –°–∞–π—Ç –æ—Ç–≤–µ—á–∞–µ—Ç (HTTP 200)
- ‚úì –ê–¥–º–∏–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úì API —Ä–∞–±–æ—Ç–∞–µ—Ç

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –§–∞–π–ª—ã —Å –ø–∞—Ä–æ–ª—è–º–∏

```bash
# –í .gitignore (–ù–ï –∫–æ–º–º–∏—Ç—è—Ç—Å—è):
deployment-scripts/config.sh    # SSH credentials
.env                             # Docker passwords

# –®–∞–±–ª–æ–Ω—ã (–≤ git):
deployment-scripts/config.example.sh
.env.example
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ config.sh

```bash
cd deployment-scripts
cp config.example.sh config.sh
chmod 600 config.sh  # –í–∞–∂–Ω–æ!
nano config.sh

# –ó–∞–ø–æ–ª–Ω–∏—Ç—å:
PROD_SSH_USER="your_user"
PROD_SSH_HOST="your_ip"
PROD_WEBROOT="/path/to/site"
```

## üÜò Troubleshooting

### –°–∫—Ä–∏–ø—Ç –≥–æ–≤–æ—Ä–∏—Ç "First deployment detected"

```bash
# –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞!
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
./initial-deploy.sh prod

# –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
./deploy-prod.sh  # —ç—Ç–æ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
```

### SSH connection failed

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –∫–ª—é—á–∏
ssh-add -l
ssh-add ~/.ssh/id_rsa

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ssh your_user@your_server
```

### Permission denied

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh your_user@your_server
sudo chown -R $USER:$USER /path/to/site
```

### Git pull failed

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å Git
ssh your_user@your_server
cd /path/to/site
git status
git remote -v
```

### –°–∞–π—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è
./rollback.sh prod

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh your_user@your_server
tail -f /var/log/nginx/error.log
tail -f /var/log/php-fpm/error.log
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

| –°–∫—Ä–∏–ø—Ç | –ö–æ–≥–¥–∞ | –ú–µ—Ç–æ–¥ | –°–∫–æ—Ä–æ—Å—Ç—å | –ü—Ä–æ–≤–µ—Ä–∫–∏ |
|--------|-------|-------|----------|----------|
| `initial-deploy.sh` | –ü–µ—Ä–≤—ã–π —Ä–∞–∑ | rsync | üê¢ 5-10 –º–∏–Ω | –ë–∞–∑–æ–≤—ã–µ + üîí htpasswd (DEV) |
| `deploy-prod.sh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏—è PROD | git pull | ‚ö° 30 —Å–µ–∫ | –ü–æ–ª–Ω—ã–µ |
| `deploy-dev.sh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏—è DEV | git pull | ‚ö° 10 —Å–µ–∫ | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ |
| `hotfix.sh` | –°—Ä–æ—á–Ω—ã–µ —Ñ–∏–∫—Å—ã | git cherry-pick | ‚ö° 1 –º–∏–Ω | –°—Ä–µ–¥–Ω–∏–µ |
| `rollback.sh` | –û—Ç–∫–∞—Ç | git reset | ‚ö° 20 —Å–µ–∫ | Smoke tests |

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [README.md](../README.md) ‚Äî –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- [DEPLOYMENT_GUIDE.md](DEPLOYMENT_GUIDE.md) ‚Äî –ø–æ–ª–Ω—ã–π –≥–∞–π–¥
- [INITIAL_DEPLOYMENT.md](INITIAL_DEPLOYMENT.md) ‚Äî –¥–µ—Ç–∞–ª–∏ –ø–µ—Ä–≤–æ–≥–æ –¥–µ–ø–ª–æ—è
- [.deployignore](../.deployignore) ‚Äî —á—Ç–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

```bash
‚ñ° –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
‚ñ° –ë–∏–ª–¥ —É—Å–ø–µ—à–µ–Ω (CSS/JS —Å–æ–±—Ä–∞–Ω—ã)
‚ñ° –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
‚ñ° –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—É—à–µ–Ω—ã –≤ –Ω—É–∂–Ω—É—é –≤–µ—Ç–∫—É
‚ñ° config.sh –Ω–∞—Å—Ç—Ä–æ–µ–Ω
‚ñ° SSH –¥–æ—Å—Ç—É–ø —Ä–∞–±–æ—Ç–∞–µ—Ç
‚ñ° –ï—Å—Ç—å —Å–≤–µ–∂–∏–π –±—ç–∫–∞–ø (–¥–ª—è PROD)
‚ñ° –£–≤–µ–¥–æ–º–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ (–¥–ª—è PROD)
```

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è
git diff origin/main

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–µ–ø–ª–æ–µ–≤ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
ssh user@server
cd /path/to/site
git log --oneline -10

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh user@server "cd /path/to/site && git rev-parse --short HEAD"

# –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤
ssh user@server "ls -lth /path/to/backups | head -10"

# –†–∞–∑–º–µ—Ä —Å–∞–π—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh user@server "du -sh /path/to/site"
```

## üîí HTTP Authentication (DEV)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞—â–∏—Ç—ã
./deployment-scripts/utils/manage-htpasswd.sh status

# –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
./deployment-scripts/utils/manage-htpasswd.sh change

# –û—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É (–≤—Ä–µ–º–µ–Ω–Ω–æ)
./deployment-scripts/utils/manage-htpasswd.sh disable

# –í–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞—Ç–Ω–æ
./deployment-scripts/utils/manage-htpasswd.sh enable
```

**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è DEV:**
- Username: `test`
- Password: `test`

---

**üöÄ Happy Deploying!**

